[
  {
    "objectID": "notebooks/technical-snippets.html",
    "href": "notebooks/technical-snippets.html",
    "title": "Nurse Staffing Recommendations",
    "section": "",
    "text": "[…]"
  },
  {
    "objectID": "notebooks/technical-snippets.html#imports",
    "href": "notebooks/technical-snippets.html#imports",
    "title": "Nurse Staffing Recommendations",
    "section": "Imports",
    "text": "Imports\n\n\nCode\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom great_tables import GT\nfrom pandas.plotting import scatter_matrix\n\nfrom src.stylesheet import customize_plots\nfrom src.inspection import make_df, display"
  },
  {
    "objectID": "notebooks/technical-snippets.html#the-dataset",
    "href": "notebooks/technical-snippets.html#the-dataset",
    "title": "Nurse Staffing Recommendations",
    "section": "The dataset",
    "text": "The dataset\nWe begin by exploring the data to get to know the features and patterns on which we will base our analysis.\n\n\nCode\nif 'data' not in locals():\n    data = pd.read_csv(\n        \"../data/raw/PBJ_Daily_Nurse_Staffing_Q1_2024.zip\",\n        encoding='ISO-8859-1'\n    )\nelse:\n    print(\"data loaded.\")\n\n\n\n\nCode\ndata.sample(5)\n\n\n\n\n\n  \n    \n      \n      PROVNUM\n      PROVNAME\n      CITY\n      STATE\n      COUNTY_NAME\n      COUNTY_FIPS\n      CY_Qtr\n      WorkDate\n      MDScensus\n      Hrs_RNDON\n      ...\n      Hrs_LPN_ctr\n      Hrs_CNA\n      Hrs_CNA_emp\n      Hrs_CNA_ctr\n      Hrs_NAtrn\n      Hrs_NAtrn_emp\n      Hrs_NAtrn_ctr\n      Hrs_MedAide\n      Hrs_MedAide_emp\n      Hrs_MedAide_ctr\n    \n  \n  \n    \n      233053\n      115513\n      TWIN OAKS CONVALESCENT CENTER\n      ALMA\n      GA\n      Bacon\n      5\n      2024Q1\n      20240103\n      72\n      8.0\n      ...\n      36.20\n      146.40\n      146.40\n      0.0\n      0.0\n      0.0\n      0.0\n      0.00\n      0.00\n      0.0\n    \n    \n      1109690\n      46A058\n      MAPLE RIDGE REHABILITATION AND NURSING\n      SALT LAKE CITY\n      UT\n      Salt Lake\n      35\n      2024Q1\n      20240206\n      34\n      0.0\n      ...\n      0.00\n      47.16\n      47.16\n      0.0\n      0.0\n      0.0\n      0.0\n      0.00\n      0.00\n      0.0\n    \n    \n      1071036\n      445426\n      AHC BRIGHT GLADE\n      MEMPHIS\n      TN\n      Shelby\n      157\n      2024Q1\n      20240227\n      68\n      8.0\n      ...\n      47.98\n      110.50\n      99.00\n      11.5\n      0.0\n      0.0\n      0.0\n      0.00\n      0.00\n      0.0\n    \n    \n      902705\n      366234\n      COLONIAL NURSING CENTER OF ROCKFORD\n      ROCKFORD\n      OH\n      Mercer\n      107\n      2024Q1\n      20240317\n      17\n      0.0\n      ...\n      0.00\n      38.25\n      38.25\n      0.0\n      0.0\n      0.0\n      0.0\n      0.00\n      0.00\n      0.0\n    \n    \n      924408\n      375124\n      SEQUOYAH POINTE SKILLED NURSING AND THERAPY\n      TAHLEQUAH\n      OK\n      Cherokee\n      21\n      2024Q1\n      20240131\n      59\n      8.0\n      ...\n      0.00\n      80.92\n      80.92\n      0.0\n      0.0\n      0.0\n      0.0\n      14.83\n      14.83\n      0.0\n    \n  \n\n5 rows × 33 columns\n\n\n\n\n\nCode\n# TODO: pivot on day\n\ndata_pivoted = data.pivot_table(\n    index=\"STATE\",\n    columns=\"WorkDate\",\n    values=\"Hrs_RN\",\n    aggfunc='mean'\n)\n\n# Resetting the index for easier column access\n# data_pivoted.reset_index(inplace=True)\ndata_pivoted\n\n\n\n\n\n  \n    \n      WorkDate\n      20240101\n      20240102\n      20240103\n      20240104\n      20240105\n      20240106\n      20240107\n      20240108\n      20240109\n      20240110\n      ...\n      20240322\n      20240323\n      20240324\n      20240325\n      20240326\n      20240327\n      20240328\n      20240329\n      20240330\n      20240331\n    \n    \n      STATE\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n  \n    \n      AK\n      55.602000\n      51.898667\n      51.343333\n      59.512000\n      64.569333\n      58.176000\n      57.300000\n      60.578000\n      58.515333\n      59.689333\n      ...\n      62.525333\n      53.939333\n      57.629333\n      63.704000\n      63.604000\n      63.441333\n      65.700000\n      68.357333\n      54.641333\n      54.074000\n    \n    \n      AL\n      26.901570\n      39.632601\n      40.746816\n      40.160404\n      38.657937\n      26.692466\n      26.345874\n      38.713184\n      40.700897\n      41.691390\n      ...\n      38.314529\n      26.940000\n      26.800493\n      39.800852\n      41.089238\n      40.966502\n      39.004753\n      36.495605\n      27.455964\n      26.797085\n    \n    \n      AR\n      11.224470\n      12.514240\n      13.073456\n      13.465346\n      12.282304\n      12.595714\n      12.768341\n      13.161244\n      13.578756\n      13.734608\n      ...\n      13.382811\n      13.832995\n      13.381382\n      13.655576\n      13.879217\n      13.432074\n      14.206129\n      13.426175\n      13.525300\n      11.958571\n    \n    \n      AZ\n      33.938777\n      36.368273\n      37.029137\n      36.852158\n      36.982302\n      33.031655\n      31.628849\n      38.353525\n      38.457194\n      38.849496\n      ...\n      41.056331\n      34.905971\n      32.476691\n      40.276331\n      39.088633\n      40.678417\n      40.659353\n      39.422662\n      32.910216\n      31.528417\n    \n    \n      CA\n      29.643939\n      32.223912\n      32.686316\n      33.311368\n      32.586842\n      29.678272\n      29.393482\n      32.683263\n      33.510465\n      33.730807\n      ...\n      34.460474\n      31.168947\n      30.193833\n      33.812158\n      34.870868\n      34.675798\n      34.780860\n      33.950561\n      30.720272\n      29.810675\n    \n    \n      CO\n      37.223095\n      40.186095\n      40.631190\n      40.072571\n      40.423095\n      38.004381\n      37.096857\n      40.466143\n      40.956571\n      43.137571\n      ...\n      41.452905\n      38.295714\n      39.097857\n      43.101476\n      43.028905\n      41.711476\n      42.061190\n      40.556190\n      38.602524\n      38.213476\n    \n    \n      CT\n      35.593010\n      39.137245\n      40.845051\n      39.577806\n      38.820612\n      33.855204\n      34.137908\n      39.099490\n      40.483163\n      39.878827\n      ...\n      39.189592\n      33.277602\n      31.573061\n      38.741531\n      40.119184\n      39.543520\n      40.140561\n      36.694745\n      32.471837\n      31.387959\n    \n    \n      DC\n      76.412353\n      96.951176\n      92.495294\n      93.214118\n      94.737647\n      89.853529\n      79.513529\n      93.113529\n      102.617647\n      98.691176\n      ...\n      99.601765\n      92.243529\n      86.057647\n      94.458235\n      98.186471\n      92.970588\n      93.760000\n      88.358235\n      91.500588\n      76.418235\n    \n    \n      DE\n      48.073488\n      49.806977\n      52.222558\n      52.358140\n      50.613488\n      49.409535\n      48.332093\n      52.329767\n      55.013256\n      50.222791\n      ...\n      49.123721\n      51.508837\n      48.232326\n      47.708140\n      50.664651\n      51.872558\n      48.328140\n      47.305116\n      45.268372\n      42.826744\n    \n    \n      FL\n      44.208719\n      50.528245\n      51.586115\n      52.331007\n      51.401856\n      46.673655\n      45.565885\n      51.473655\n      53.545151\n      53.236964\n      ...\n      51.229914\n      48.472259\n      47.472763\n      52.853094\n      53.878158\n      53.967165\n      54.456302\n      51.843554\n      47.808043\n      46.299813\n    \n    \n      GA\n      18.511880\n      21.782165\n      22.803134\n      22.763162\n      22.722194\n      20.417037\n      20.057635\n      22.864302\n      23.227607\n      23.946068\n      ...\n      24.247806\n      22.377379\n      21.331966\n      24.187123\n      23.762023\n      24.624986\n      24.295670\n      22.414701\n      20.935271\n      20.027094\n    \n    \n      HI\n      70.109024\n      88.061707\n      89.378049\n      91.360000\n      90.813902\n      82.126829\n      74.779268\n      88.334146\n      89.205854\n      92.882439\n      ...\n      93.746585\n      81.097561\n      78.782195\n      95.884634\n      91.368780\n      95.997805\n      93.272927\n      89.069756\n      82.426341\n      76.437317\n    \n    \n      IA\n      22.838333\n      25.139621\n      25.236010\n      25.513889\n      25.689773\n      22.793131\n      22.964242\n      25.570581\n      25.039217\n      26.123813\n      ...\n      25.164596\n      23.802424\n      22.907020\n      25.947828\n      26.335581\n      26.775455\n      25.962475\n      24.953308\n      22.896490\n      22.409823\n    \n    \n      ID\n      24.325625\n      28.599875\n      30.391125\n      28.897375\n      28.103750\n      24.045875\n      23.750125\n      28.526000\n      28.961125\n      30.794750\n      ...\n      27.769750\n      22.179375\n      21.824125\n      28.623000\n      29.044000\n      30.715250\n      30.324500\n      28.523500\n      24.516375\n      23.193000\n    \n    \n      IL\n      40.518741\n      44.895289\n      45.480474\n      45.632133\n      45.581022\n      41.334370\n      40.201111\n      45.400563\n      45.447378\n      46.953244\n      ...\n      47.107763\n      42.229156\n      40.569941\n      47.162044\n      47.277807\n      47.474726\n      46.309956\n      47.338741\n      41.243615\n      38.754933\n    \n    \n      IN\n      25.732172\n      26.477378\n      26.469726\n      26.316282\n      26.849159\n      25.401272\n      25.668023\n      27.186947\n      26.782172\n      26.740294\n      ...\n      27.254795\n      25.644384\n      25.083816\n      27.937339\n      27.813249\n      27.635245\n      26.700900\n      26.755029\n      25.423033\n      24.693640\n    \n    \n      KS\n      20.998758\n      22.468557\n      21.725067\n      22.755403\n      21.948423\n      20.589765\n      21.222181\n      22.365369\n      21.057148\n      22.555738\n      ...\n      22.888289\n      21.562215\n      21.660872\n      22.672181\n      23.354430\n      23.047752\n      23.815570\n      21.909295\n      20.511711\n      21.205638\n    \n    \n      KY\n      30.264755\n      33.232981\n      33.452453\n      32.860830\n      32.436604\n      31.494491\n      30.550566\n      33.331434\n      33.687321\n      33.299925\n      ...\n      33.258830\n      30.906906\n      30.522264\n      34.141698\n      34.794868\n      34.302491\n      33.599132\n      32.082981\n      31.581585\n      30.353472\n    \n    \n      LA\n      9.650920\n      10.003793\n      10.045670\n      9.992261\n      9.947931\n      10.447778\n      10.562222\n      9.285556\n      9.646015\n      9.772605\n      ...\n      10.842529\n      10.900536\n      10.620383\n      10.169885\n      10.666207\n      10.960575\n      10.225441\n      9.383602\n      11.024904\n      10.359080\n    \n    \n      MA\n      39.254503\n      38.644211\n      38.419620\n      39.251901\n      39.735731\n      37.411550\n      36.665439\n      38.615702\n      40.270848\n      39.968743\n      ...\n      37.619327\n      37.945175\n      37.180029\n      38.855439\n      39.771871\n      39.055585\n      39.775117\n      37.979064\n      36.909591\n      35.394269\n    \n    \n      MD\n      48.480909\n      53.835227\n      54.747364\n      55.366591\n      54.434455\n      51.844227\n      48.868091\n      53.992182\n      52.681773\n      54.975500\n      ...\n      54.698136\n      52.541818\n      50.319909\n      51.897545\n      53.571273\n      53.860591\n      52.873409\n      51.027364\n      51.012364\n      46.693727\n    \n    \n      ME\n      44.605679\n      52.675309\n      53.210000\n      52.965062\n      51.634815\n      44.355556\n      41.703951\n      51.504198\n      52.985556\n      55.204691\n      ...\n      48.337037\n      41.466420\n      41.231235\n      49.511975\n      53.554568\n      52.495556\n      50.995802\n      49.387284\n      41.715309\n      38.399012\n    \n    \n      MI\n      31.840403\n      35.916919\n      37.510735\n      37.633555\n      36.627038\n      32.023081\n      31.603744\n      37.168246\n      37.636659\n      38.506374\n      ...\n      37.415711\n      31.798578\n      31.736635\n      36.540000\n      37.735261\n      38.089076\n      37.717820\n      36.175047\n      32.036730\n      31.153649\n    \n    \n      MN\n      35.033314\n      41.024763\n      42.313580\n      41.688905\n      41.074527\n      35.065059\n      35.787574\n      41.939527\n      41.977041\n      42.187899\n      ...\n      42.760355\n      36.127544\n      35.741124\n      42.164408\n      44.007663\n      44.367130\n      44.285651\n      41.874822\n      36.725976\n      35.565917\n    \n    \n      MO\n      15.788498\n      17.543992\n      17.468642\n      17.357160\n      16.954444\n      17.107634\n      16.576749\n      16.787160\n      18.045782\n      18.238128\n      ...\n      17.214198\n      16.847510\n      17.005103\n      17.233601\n      17.648663\n      18.301152\n      18.063765\n      17.021029\n      16.695535\n      16.083642\n    \n    \n      MS\n      20.827300\n      27.172750\n      28.003300\n      28.498150\n      27.329850\n      20.201300\n      20.731500\n      27.697700\n      28.925200\n      29.731550\n      ...\n      28.730550\n      21.192800\n      21.478200\n      29.157300\n      28.901850\n      29.581950\n      29.549300\n      26.510700\n      19.974450\n      18.968100\n    \n    \n      MT\n      28.274407\n      34.167458\n      34.420000\n      34.653898\n      33.428814\n      29.468983\n      31.083729\n      37.317458\n      36.488136\n      35.959153\n      ...\n      33.908475\n      30.398305\n      30.253898\n      36.602203\n      38.875763\n      36.122203\n      34.598475\n      34.552712\n      30.409492\n      29.599831\n    \n    \n      NC\n      22.247976\n      24.949341\n      26.265512\n      25.999024\n      25.496902\n      23.229317\n      22.181122\n      25.546537\n      25.902829\n      26.529268\n      ...\n      27.260585\n      23.662317\n      22.993244\n      26.488732\n      26.931488\n      26.507659\n      26.110000\n      25.758000\n      22.889122\n      22.017049\n    \n    \n      ND\n      31.860270\n      38.348243\n      40.633378\n      38.023243\n      35.265811\n      31.280405\n      32.373243\n      39.425676\n      39.420270\n      39.784459\n      ...\n      37.855811\n      31.349595\n      31.869730\n      39.188514\n      39.367568\n      39.229189\n      37.719865\n      34.812432\n      30.955676\n      30.993243\n    \n    \n      NE\n      23.365419\n      25.272235\n      24.100279\n      25.115196\n      23.302626\n      24.454190\n      23.630559\n      24.344693\n      23.463240\n      25.403911\n      ...\n      23.552905\n      24.252905\n      23.816480\n      25.028380\n      25.604916\n      25.195363\n      24.540056\n      23.927542\n      24.645307\n      23.921620\n    \n    \n      NH\n      36.059041\n      41.363151\n      44.759589\n      44.145205\n      41.795479\n      32.758630\n      32.066301\n      40.983425\n      44.204932\n      41.722329\n      ...\n      42.447808\n      35.066164\n      34.268630\n      41.997260\n      42.030000\n      44.547123\n      47.387260\n      44.094521\n      33.299863\n      32.937534\n    \n    \n      NJ\n      42.600754\n      48.751014\n      50.149623\n      50.088000\n      48.413246\n      45.385159\n      43.822783\n      48.486754\n      48.916783\n      49.859275\n      ...\n      49.296638\n      45.939188\n      43.943304\n      48.825072\n      50.997246\n      50.196638\n      49.631855\n      47.144377\n      44.858232\n      42.703942\n    \n    \n      NM\n      33.375758\n      36.692727\n      37.505909\n      35.649697\n      37.853939\n      34.315455\n      34.202727\n      38.273182\n      38.841818\n      37.853182\n      ...\n      38.443636\n      36.525606\n      36.071212\n      39.288485\n      39.542727\n      37.958939\n      38.241212\n      37.816364\n      34.915758\n      34.398788\n    \n    \n      NV\n      41.530625\n      45.082813\n      46.118125\n      46.608438\n      46.916875\n      41.337812\n      42.300156\n      47.543750\n      47.189531\n      47.128906\n      ...\n      50.780313\n      46.901250\n      45.053906\n      48.429688\n      50.456406\n      49.255469\n      49.613906\n      52.946719\n      45.201250\n      41.933594\n    \n    \n      NY\n      63.037970\n      83.355557\n      87.962745\n      87.876689\n      85.887238\n      63.016772\n      59.786040\n      86.420782\n      88.668419\n      89.539917\n      ...\n      87.225824\n      63.389218\n      60.537787\n      86.742646\n      90.201764\n      89.666972\n      87.925940\n      83.728253\n      63.175507\n      59.169018\n    \n    \n      OH\n      24.006580\n      26.962200\n      27.150054\n      26.666503\n      26.430294\n      24.175632\n      24.283965\n      27.093192\n      27.466035\n      27.726634\n      ...\n      27.942298\n      25.253976\n      25.000142\n      27.565142\n      28.322538\n      27.940294\n      26.981373\n      26.369423\n      24.751939\n      24.371797\n    \n    \n      OK\n      10.247391\n      10.938406\n      10.680000\n      11.024094\n      11.159855\n      13.248297\n      12.748007\n      10.697790\n      11.148551\n      11.108478\n      ...\n      10.873188\n      13.280797\n      13.058768\n      11.140942\n      12.103551\n      11.680000\n      11.218949\n      11.324964\n      14.275652\n      13.919058\n    \n    \n      OR\n      18.993307\n      21.867244\n      21.657795\n      21.835591\n      20.673386\n      18.534331\n      18.504488\n      21.327953\n      21.789921\n      22.587087\n      ...\n      21.738583\n      19.176457\n      19.684331\n      21.581496\n      20.215039\n      21.213465\n      22.737165\n      20.783780\n      19.890394\n      18.842835\n    \n    \n      PA\n      42.059970\n      46.567113\n      47.094617\n      47.600286\n      46.890782\n      41.861233\n      40.447368\n      47.176165\n      48.155910\n      48.193835\n      ...\n      48.677895\n      43.529474\n      42.168256\n      48.857624\n      49.355835\n      49.345744\n      49.219534\n      46.220030\n      41.910677\n      40.328812\n    \n    \n      PR\n      49.450000\n      67.460000\n      63.000000\n      67.940000\n      59.160000\n      51.060000\n      45.510000\n      62.410000\n      64.350000\n      60.830000\n      ...\n      63.300000\n      58.020000\n      51.220000\n      66.340000\n      66.700000\n      58.670000\n      73.580000\n      60.520000\n      56.920000\n      46.660000\n    \n    \n      RI\n      45.887260\n      54.173151\n      53.897808\n      52.802603\n      51.161370\n      44.001781\n      43.298767\n      51.065205\n      51.492603\n      54.292055\n      ...\n      54.486986\n      46.774658\n      44.722740\n      51.855342\n      59.626712\n      56.186164\n      57.319726\n      52.652877\n      44.697808\n      44.168219\n    \n    \n      SC\n      26.868649\n      30.011297\n      30.351351\n      31.029351\n      31.282432\n      26.417027\n      25.796703\n      32.142486\n      31.716811\n      31.473135\n      ...\n      32.768108\n      27.239946\n      26.613622\n      32.162054\n      33.461027\n      32.779622\n      33.697189\n      31.534378\n      26.205838\n      26.416270\n    \n    \n      SD\n      23.937872\n      27.887021\n      28.650957\n      28.709362\n      25.869787\n      23.294362\n      23.468936\n      26.565426\n      27.689362\n      28.507979\n      ...\n      27.204468\n      24.379681\n      24.976383\n      28.903298\n      27.910106\n      28.876596\n      29.154362\n      25.915426\n      23.493617\n      23.390851\n    \n    \n      TN\n      25.497533\n      28.158567\n      28.439533\n      29.564267\n      28.117767\n      25.960967\n      25.285133\n      28.508100\n      29.937000\n      30.364300\n      ...\n      27.939400\n      25.935067\n      25.294100\n      29.386033\n      29.668300\n      29.138300\n      29.023500\n      27.571300\n      25.624767\n      25.035000\n    \n    \n      TX\n      15.509923\n      16.095541\n      16.479777\n      16.861229\n      16.301117\n      18.420490\n      17.912766\n      16.624863\n      16.983634\n      16.666486\n      ...\n      17.127612\n      19.585756\n      19.274991\n      17.441134\n      17.478565\n      17.839192\n      17.482801\n      17.273505\n      19.546521\n      18.477354\n    \n    \n      UT\n      40.377143\n      45.121837\n      46.036122\n      46.057347\n      45.367347\n      40.556531\n      39.558571\n      45.473878\n      46.693673\n      46.937857\n      ...\n      46.381735\n      43.381939\n      41.842755\n      47.288776\n      49.215102\n      47.684286\n      47.572245\n      44.711735\n      40.650816\n      38.821735\n    \n    \n      VA\n      27.820523\n      29.123484\n      29.978780\n      30.093240\n      30.922822\n      27.202439\n      27.001533\n      29.502265\n      29.475575\n      30.275923\n      ...\n      32.296028\n      28.278362\n      26.743066\n      31.306899\n      32.950209\n      32.211638\n      31.160836\n      30.319443\n      29.397491\n      28.079443\n    \n    \n      VT\n      34.996176\n      47.094118\n      47.409118\n      46.076176\n      44.170588\n      33.863824\n      35.785000\n      43.345882\n      43.502353\n      44.892059\n      ...\n      40.041765\n      33.454706\n      32.431765\n      43.552647\n      44.873824\n      45.265588\n      44.974706\n      43.513235\n      34.146471\n      31.770294\n    \n    \n      WA\n      40.340265\n      43.959630\n      44.146349\n      45.627725\n      44.312328\n      38.637831\n      38.580370\n      43.357672\n      45.285503\n      44.805397\n      ...\n      43.901429\n      39.084603\n      38.106349\n      43.540265\n      43.917037\n      44.294339\n      45.304021\n      43.859894\n      38.895344\n      36.047619\n    \n    \n      WI\n      31.700062\n      34.592870\n      35.048611\n      34.292222\n      35.131759\n      31.044475\n      30.880710\n      33.966605\n      34.670494\n      36.419074\n      ...\n      33.826481\n      31.124568\n      31.288025\n      34.194537\n      36.365957\n      36.249784\n      34.550586\n      33.599722\n      31.473148\n      31.153951\n    \n    \n      WV\n      20.471230\n      33.144754\n      34.094262\n      32.715246\n      31.868033\n      22.048525\n      21.155082\n      32.295984\n      33.005820\n      33.247295\n      ...\n      31.105082\n      22.139098\n      21.513443\n      30.750738\n      33.134016\n      33.936393\n      31.578934\n      29.795328\n      21.780984\n      20.225246\n    \n    \n      WY\n      36.964062\n      36.274062\n      37.367500\n      37.316563\n      36.533750\n      30.890000\n      35.560625\n      41.456250\n      39.648750\n      39.137188\n      ...\n      38.049062\n      33.010625\n      34.812812\n      38.780938\n      40.523125\n      37.850625\n      36.653750\n      34.769375\n      31.446250\n      32.068438\n    \n  \n\n52 rows × 91 columns\n\n\n\n\n\nCode\ndata_pivoted.iloc[:, 1:]\n\n\n\n\n\n  \n    \n      WorkDate\n      20240102\n      20240103\n      20240104\n      20240105\n      20240106\n      20240107\n      20240108\n      20240109\n      20240110\n      20240111\n      ...\n      20240322\n      20240323\n      20240324\n      20240325\n      20240326\n      20240327\n      20240328\n      20240329\n      20240330\n      20240331\n    \n    \n      STATE\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n  \n    \n      AK\n      51.898667\n      51.343333\n      59.512000\n      64.569333\n      58.176000\n      57.300000\n      60.578000\n      58.515333\n      59.689333\n      60.191333\n      ...\n      62.525333\n      53.939333\n      57.629333\n      63.704000\n      63.604000\n      63.441333\n      65.700000\n      68.357333\n      54.641333\n      54.074000\n    \n    \n      AL\n      39.632601\n      40.746816\n      40.160404\n      38.657937\n      26.692466\n      26.345874\n      38.713184\n      40.700897\n      41.691390\n      41.597578\n      ...\n      38.314529\n      26.940000\n      26.800493\n      39.800852\n      41.089238\n      40.966502\n      39.004753\n      36.495605\n      27.455964\n      26.797085\n    \n    \n      AR\n      12.514240\n      13.073456\n      13.465346\n      12.282304\n      12.595714\n      12.768341\n      13.161244\n      13.578756\n      13.734608\n      14.105069\n      ...\n      13.382811\n      13.832995\n      13.381382\n      13.655576\n      13.879217\n      13.432074\n      14.206129\n      13.426175\n      13.525300\n      11.958571\n    \n    \n      AZ\n      36.368273\n      37.029137\n      36.852158\n      36.982302\n      33.031655\n      31.628849\n      38.353525\n      38.457194\n      38.849496\n      37.948273\n      ...\n      41.056331\n      34.905971\n      32.476691\n      40.276331\n      39.088633\n      40.678417\n      40.659353\n      39.422662\n      32.910216\n      31.528417\n    \n    \n      CA\n      32.223912\n      32.686316\n      33.311368\n      32.586842\n      29.678272\n      29.393482\n      32.683263\n      33.510465\n      33.730807\n      33.616746\n      ...\n      34.460474\n      31.168947\n      30.193833\n      33.812158\n      34.870868\n      34.675798\n      34.780860\n      33.950561\n      30.720272\n      29.810675\n    \n    \n      CO\n      40.186095\n      40.631190\n      40.072571\n      40.423095\n      38.004381\n      37.096857\n      40.466143\n      40.956571\n      43.137571\n      42.541476\n      ...\n      41.452905\n      38.295714\n      39.097857\n      43.101476\n      43.028905\n      41.711476\n      42.061190\n      40.556190\n      38.602524\n      38.213476\n    \n    \n      CT\n      39.137245\n      40.845051\n      39.577806\n      38.820612\n      33.855204\n      34.137908\n      39.099490\n      40.483163\n      39.878827\n      40.956990\n      ...\n      39.189592\n      33.277602\n      31.573061\n      38.741531\n      40.119184\n      39.543520\n      40.140561\n      36.694745\n      32.471837\n      31.387959\n    \n    \n      DC\n      96.951176\n      92.495294\n      93.214118\n      94.737647\n      89.853529\n      79.513529\n      93.113529\n      102.617647\n      98.691176\n      99.465882\n      ...\n      99.601765\n      92.243529\n      86.057647\n      94.458235\n      98.186471\n      92.970588\n      93.760000\n      88.358235\n      91.500588\n      76.418235\n    \n    \n      DE\n      49.806977\n      52.222558\n      52.358140\n      50.613488\n      49.409535\n      48.332093\n      52.329767\n      55.013256\n      50.222791\n      52.626047\n      ...\n      49.123721\n      51.508837\n      48.232326\n      47.708140\n      50.664651\n      51.872558\n      48.328140\n      47.305116\n      45.268372\n      42.826744\n    \n    \n      FL\n      50.528245\n      51.586115\n      52.331007\n      51.401856\n      46.673655\n      45.565885\n      51.473655\n      53.545151\n      53.236964\n      53.812101\n      ...\n      51.229914\n      48.472259\n      47.472763\n      52.853094\n      53.878158\n      53.967165\n      54.456302\n      51.843554\n      47.808043\n      46.299813\n    \n    \n      GA\n      21.782165\n      22.803134\n      22.763162\n      22.722194\n      20.417037\n      20.057635\n      22.864302\n      23.227607\n      23.946068\n      23.938661\n      ...\n      24.247806\n      22.377379\n      21.331966\n      24.187123\n      23.762023\n      24.624986\n      24.295670\n      22.414701\n      20.935271\n      20.027094\n    \n    \n      HI\n      88.061707\n      89.378049\n      91.360000\n      90.813902\n      82.126829\n      74.779268\n      88.334146\n      89.205854\n      92.882439\n      92.818293\n      ...\n      93.746585\n      81.097561\n      78.782195\n      95.884634\n      91.368780\n      95.997805\n      93.272927\n      89.069756\n      82.426341\n      76.437317\n    \n    \n      IA\n      25.139621\n      25.236010\n      25.513889\n      25.689773\n      22.793131\n      22.964242\n      25.570581\n      25.039217\n      26.123813\n      25.783359\n      ...\n      25.164596\n      23.802424\n      22.907020\n      25.947828\n      26.335581\n      26.775455\n      25.962475\n      24.953308\n      22.896490\n      22.409823\n    \n    \n      ID\n      28.599875\n      30.391125\n      28.897375\n      28.103750\n      24.045875\n      23.750125\n      28.526000\n      28.961125\n      30.794750\n      28.783375\n      ...\n      27.769750\n      22.179375\n      21.824125\n      28.623000\n      29.044000\n      30.715250\n      30.324500\n      28.523500\n      24.516375\n      23.193000\n    \n    \n      IL\n      44.895289\n      45.480474\n      45.632133\n      45.581022\n      41.334370\n      40.201111\n      45.400563\n      45.447378\n      46.953244\n      46.710637\n      ...\n      47.107763\n      42.229156\n      40.569941\n      47.162044\n      47.277807\n      47.474726\n      46.309956\n      47.338741\n      41.243615\n      38.754933\n    \n    \n      IN\n      26.477378\n      26.469726\n      26.316282\n      26.849159\n      25.401272\n      25.668023\n      27.186947\n      26.782172\n      26.740294\n      27.403601\n      ...\n      27.254795\n      25.644384\n      25.083816\n      27.937339\n      27.813249\n      27.635245\n      26.700900\n      26.755029\n      25.423033\n      24.693640\n    \n    \n      KS\n      22.468557\n      21.725067\n      22.755403\n      21.948423\n      20.589765\n      21.222181\n      22.365369\n      21.057148\n      22.555738\n      22.512349\n      ...\n      22.888289\n      21.562215\n      21.660872\n      22.672181\n      23.354430\n      23.047752\n      23.815570\n      21.909295\n      20.511711\n      21.205638\n    \n    \n      KY\n      33.232981\n      33.452453\n      32.860830\n      32.436604\n      31.494491\n      30.550566\n      33.331434\n      33.687321\n      33.299925\n      33.754943\n      ...\n      33.258830\n      30.906906\n      30.522264\n      34.141698\n      34.794868\n      34.302491\n      33.599132\n      32.082981\n      31.581585\n      30.353472\n    \n    \n      LA\n      10.003793\n      10.045670\n      9.992261\n      9.947931\n      10.447778\n      10.562222\n      9.285556\n      9.646015\n      9.772605\n      10.311494\n      ...\n      10.842529\n      10.900536\n      10.620383\n      10.169885\n      10.666207\n      10.960575\n      10.225441\n      9.383602\n      11.024904\n      10.359080\n    \n    \n      MA\n      38.644211\n      38.419620\n      39.251901\n      39.735731\n      37.411550\n      36.665439\n      38.615702\n      40.270848\n      39.968743\n      38.243509\n      ...\n      37.619327\n      37.945175\n      37.180029\n      38.855439\n      39.771871\n      39.055585\n      39.775117\n      37.979064\n      36.909591\n      35.394269\n    \n    \n      MD\n      53.835227\n      54.747364\n      55.366591\n      54.434455\n      51.844227\n      48.868091\n      53.992182\n      52.681773\n      54.975500\n      55.072318\n      ...\n      54.698136\n      52.541818\n      50.319909\n      51.897545\n      53.571273\n      53.860591\n      52.873409\n      51.027364\n      51.012364\n      46.693727\n    \n    \n      ME\n      52.675309\n      53.210000\n      52.965062\n      51.634815\n      44.355556\n      41.703951\n      51.504198\n      52.985556\n      55.204691\n      54.661605\n      ...\n      48.337037\n      41.466420\n      41.231235\n      49.511975\n      53.554568\n      52.495556\n      50.995802\n      49.387284\n      41.715309\n      38.399012\n    \n    \n      MI\n      35.916919\n      37.510735\n      37.633555\n      36.627038\n      32.023081\n      31.603744\n      37.168246\n      37.636659\n      38.506374\n      37.041777\n      ...\n      37.415711\n      31.798578\n      31.736635\n      36.540000\n      37.735261\n      38.089076\n      37.717820\n      36.175047\n      32.036730\n      31.153649\n    \n    \n      MN\n      41.024763\n      42.313580\n      41.688905\n      41.074527\n      35.065059\n      35.787574\n      41.939527\n      41.977041\n      42.187899\n      41.705947\n      ...\n      42.760355\n      36.127544\n      35.741124\n      42.164408\n      44.007663\n      44.367130\n      44.285651\n      41.874822\n      36.725976\n      35.565917\n    \n    \n      MO\n      17.543992\n      17.468642\n      17.357160\n      16.954444\n      17.107634\n      16.576749\n      16.787160\n      18.045782\n      18.238128\n      18.421008\n      ...\n      17.214198\n      16.847510\n      17.005103\n      17.233601\n      17.648663\n      18.301152\n      18.063765\n      17.021029\n      16.695535\n      16.083642\n    \n    \n      MS\n      27.172750\n      28.003300\n      28.498150\n      27.329850\n      20.201300\n      20.731500\n      27.697700\n      28.925200\n      29.731550\n      28.892000\n      ...\n      28.730550\n      21.192800\n      21.478200\n      29.157300\n      28.901850\n      29.581950\n      29.549300\n      26.510700\n      19.974450\n      18.968100\n    \n    \n      MT\n      34.167458\n      34.420000\n      34.653898\n      33.428814\n      29.468983\n      31.083729\n      37.317458\n      36.488136\n      35.959153\n      35.653898\n      ...\n      33.908475\n      30.398305\n      30.253898\n      36.602203\n      38.875763\n      36.122203\n      34.598475\n      34.552712\n      30.409492\n      29.599831\n    \n    \n      NC\n      24.949341\n      26.265512\n      25.999024\n      25.496902\n      23.229317\n      22.181122\n      25.546537\n      25.902829\n      26.529268\n      27.181805\n      ...\n      27.260585\n      23.662317\n      22.993244\n      26.488732\n      26.931488\n      26.507659\n      26.110000\n      25.758000\n      22.889122\n      22.017049\n    \n    \n      ND\n      38.348243\n      40.633378\n      38.023243\n      35.265811\n      31.280405\n      32.373243\n      39.425676\n      39.420270\n      39.784459\n      39.696622\n      ...\n      37.855811\n      31.349595\n      31.869730\n      39.188514\n      39.367568\n      39.229189\n      37.719865\n      34.812432\n      30.955676\n      30.993243\n    \n    \n      NE\n      25.272235\n      24.100279\n      25.115196\n      23.302626\n      24.454190\n      23.630559\n      24.344693\n      23.463240\n      25.403911\n      24.793240\n      ...\n      23.552905\n      24.252905\n      23.816480\n      25.028380\n      25.604916\n      25.195363\n      24.540056\n      23.927542\n      24.645307\n      23.921620\n    \n    \n      NH\n      41.363151\n      44.759589\n      44.145205\n      41.795479\n      32.758630\n      32.066301\n      40.983425\n      44.204932\n      41.722329\n      43.894110\n      ...\n      42.447808\n      35.066164\n      34.268630\n      41.997260\n      42.030000\n      44.547123\n      47.387260\n      44.094521\n      33.299863\n      32.937534\n    \n    \n      NJ\n      48.751014\n      50.149623\n      50.088000\n      48.413246\n      45.385159\n      43.822783\n      48.486754\n      48.916783\n      49.859275\n      49.887913\n      ...\n      49.296638\n      45.939188\n      43.943304\n      48.825072\n      50.997246\n      50.196638\n      49.631855\n      47.144377\n      44.858232\n      42.703942\n    \n    \n      NM\n      36.692727\n      37.505909\n      35.649697\n      37.853939\n      34.315455\n      34.202727\n      38.273182\n      38.841818\n      37.853182\n      36.688788\n      ...\n      38.443636\n      36.525606\n      36.071212\n      39.288485\n      39.542727\n      37.958939\n      38.241212\n      37.816364\n      34.915758\n      34.398788\n    \n    \n      NV\n      45.082813\n      46.118125\n      46.608438\n      46.916875\n      41.337812\n      42.300156\n      47.543750\n      47.189531\n      47.128906\n      45.106406\n      ...\n      50.780313\n      46.901250\n      45.053906\n      48.429688\n      50.456406\n      49.255469\n      49.613906\n      52.946719\n      45.201250\n      41.933594\n    \n    \n      NY\n      83.355557\n      87.962745\n      87.876689\n      85.887238\n      63.016772\n      59.786040\n      86.420782\n      88.668419\n      89.539917\n      88.716023\n      ...\n      87.225824\n      63.389218\n      60.537787\n      86.742646\n      90.201764\n      89.666972\n      87.925940\n      83.728253\n      63.175507\n      59.169018\n    \n    \n      OH\n      26.962200\n      27.150054\n      26.666503\n      26.430294\n      24.175632\n      24.283965\n      27.093192\n      27.466035\n      27.726634\n      27.265294\n      ...\n      27.942298\n      25.253976\n      25.000142\n      27.565142\n      28.322538\n      27.940294\n      26.981373\n      26.369423\n      24.751939\n      24.371797\n    \n    \n      OK\n      10.938406\n      10.680000\n      11.024094\n      11.159855\n      13.248297\n      12.748007\n      10.697790\n      11.148551\n      11.108478\n      11.260290\n      ...\n      10.873188\n      13.280797\n      13.058768\n      11.140942\n      12.103551\n      11.680000\n      11.218949\n      11.324964\n      14.275652\n      13.919058\n    \n    \n      OR\n      21.867244\n      21.657795\n      21.835591\n      20.673386\n      18.534331\n      18.504488\n      21.327953\n      21.789921\n      22.587087\n      22.416850\n      ...\n      21.738583\n      19.176457\n      19.684331\n      21.581496\n      20.215039\n      21.213465\n      22.737165\n      20.783780\n      19.890394\n      18.842835\n    \n    \n      PA\n      46.567113\n      47.094617\n      47.600286\n      46.890782\n      41.861233\n      40.447368\n      47.176165\n      48.155910\n      48.193835\n      48.581278\n      ...\n      48.677895\n      43.529474\n      42.168256\n      48.857624\n      49.355835\n      49.345744\n      49.219534\n      46.220030\n      41.910677\n      40.328812\n    \n    \n      PR\n      67.460000\n      63.000000\n      67.940000\n      59.160000\n      51.060000\n      45.510000\n      62.410000\n      64.350000\n      60.830000\n      70.630000\n      ...\n      63.300000\n      58.020000\n      51.220000\n      66.340000\n      66.700000\n      58.670000\n      73.580000\n      60.520000\n      56.920000\n      46.660000\n    \n    \n      RI\n      54.173151\n      53.897808\n      52.802603\n      51.161370\n      44.001781\n      43.298767\n      51.065205\n      51.492603\n      54.292055\n      54.977534\n      ...\n      54.486986\n      46.774658\n      44.722740\n      51.855342\n      59.626712\n      56.186164\n      57.319726\n      52.652877\n      44.697808\n      44.168219\n    \n    \n      SC\n      30.011297\n      30.351351\n      31.029351\n      31.282432\n      26.417027\n      25.796703\n      32.142486\n      31.716811\n      31.473135\n      31.948324\n      ...\n      32.768108\n      27.239946\n      26.613622\n      32.162054\n      33.461027\n      32.779622\n      33.697189\n      31.534378\n      26.205838\n      26.416270\n    \n    \n      SD\n      27.887021\n      28.650957\n      28.709362\n      25.869787\n      23.294362\n      23.468936\n      26.565426\n      27.689362\n      28.507979\n      27.502234\n      ...\n      27.204468\n      24.379681\n      24.976383\n      28.903298\n      27.910106\n      28.876596\n      29.154362\n      25.915426\n      23.493617\n      23.390851\n    \n    \n      TN\n      28.158567\n      28.439533\n      29.564267\n      28.117767\n      25.960967\n      25.285133\n      28.508100\n      29.937000\n      30.364300\n      29.514267\n      ...\n      27.939400\n      25.935067\n      25.294100\n      29.386033\n      29.668300\n      29.138300\n      29.023500\n      27.571300\n      25.624767\n      25.035000\n    \n    \n      TX\n      16.095541\n      16.479777\n      16.861229\n      16.301117\n      18.420490\n      17.912766\n      16.624863\n      16.983634\n      16.666486\n      16.601770\n      ...\n      17.127612\n      19.585756\n      19.274991\n      17.441134\n      17.478565\n      17.839192\n      17.482801\n      17.273505\n      19.546521\n      18.477354\n    \n    \n      UT\n      45.121837\n      46.036122\n      46.057347\n      45.367347\n      40.556531\n      39.558571\n      45.473878\n      46.693673\n      46.937857\n      47.847551\n      ...\n      46.381735\n      43.381939\n      41.842755\n      47.288776\n      49.215102\n      47.684286\n      47.572245\n      44.711735\n      40.650816\n      38.821735\n    \n    \n      VA\n      29.123484\n      29.978780\n      30.093240\n      30.922822\n      27.202439\n      27.001533\n      29.502265\n      29.475575\n      30.275923\n      31.851882\n      ...\n      32.296028\n      28.278362\n      26.743066\n      31.306899\n      32.950209\n      32.211638\n      31.160836\n      30.319443\n      29.397491\n      28.079443\n    \n    \n      VT\n      47.094118\n      47.409118\n      46.076176\n      44.170588\n      33.863824\n      35.785000\n      43.345882\n      43.502353\n      44.892059\n      46.311176\n      ...\n      40.041765\n      33.454706\n      32.431765\n      43.552647\n      44.873824\n      45.265588\n      44.974706\n      43.513235\n      34.146471\n      31.770294\n    \n    \n      WA\n      43.959630\n      44.146349\n      45.627725\n      44.312328\n      38.637831\n      38.580370\n      43.357672\n      45.285503\n      44.805397\n      44.765397\n      ...\n      43.901429\n      39.084603\n      38.106349\n      43.540265\n      43.917037\n      44.294339\n      45.304021\n      43.859894\n      38.895344\n      36.047619\n    \n    \n      WI\n      34.592870\n      35.048611\n      34.292222\n      35.131759\n      31.044475\n      30.880710\n      33.966605\n      34.670494\n      36.419074\n      35.209352\n      ...\n      33.826481\n      31.124568\n      31.288025\n      34.194537\n      36.365957\n      36.249784\n      34.550586\n      33.599722\n      31.473148\n      31.153951\n    \n    \n      WV\n      33.144754\n      34.094262\n      32.715246\n      31.868033\n      22.048525\n      21.155082\n      32.295984\n      33.005820\n      33.247295\n      33.723689\n      ...\n      31.105082\n      22.139098\n      21.513443\n      30.750738\n      33.134016\n      33.936393\n      31.578934\n      29.795328\n      21.780984\n      20.225246\n    \n    \n      WY\n      36.274062\n      37.367500\n      37.316563\n      36.533750\n      30.890000\n      35.560625\n      41.456250\n      39.648750\n      39.137188\n      34.996875\n      ...\n      38.049062\n      33.010625\n      34.812812\n      38.780938\n      40.523125\n      37.850625\n      36.653750\n      34.769375\n      31.446250\n      32.068438\n    \n  \n\n52 rows × 90 columns\n\n\n\n\n\nCode\n(\n    GT(data_pivoted, rowname_col=\"STATE\")\n    .fmt_nanoplot(\n        columns=data_pivoted.columns[1:],\n        reference_line=\"mean\",\n        reference_area=[\"min\", \"q1\"]\n    )\n    .fmt_nanoplot(\n        columns=data_pivoted.columns[1:],\n        plot_type=\"bar\",\n        reference_line=\"max\",\n        reference_area=[\"max\", \"median\"]\n    )\n)\n\n\n\n\nCode\ndata.describe().round(1)\n# display(Markdown(data.describe().to_markdown()))\n\n\n\n\n\n  \n    \n      \n      COUNTY_FIPS\n      WorkDate\n      MDScensus\n      Hrs_RNDON\n      Hrs_RNDON_emp\n      Hrs_RNDON_ctr\n      Hrs_RNadmin\n      Hrs_RNadmin_emp\n      Hrs_RNadmin_ctr\n      Hrs_RN\n      ...\n      Hrs_LPN_ctr\n      Hrs_CNA\n      Hrs_CNA_emp\n      Hrs_CNA_ctr\n      Hrs_NAtrn\n      Hrs_NAtrn_emp\n      Hrs_NAtrn_ctr\n      Hrs_MedAide\n      Hrs_MedAide_emp\n      Hrs_MedAide_ctr\n    \n  \n  \n    \n      count\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      ...\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n    \n    \n      mean\n      91.1\n      20240215.7\n      83.4\n      5.2\n      5.1\n      0.1\n      10.3\n      10.0\n      0.2\n      34.4\n      ...\n      6.5\n      171.2\n      158.2\n      13.0\n      4.2\n      4.2\n      0.1\n      8.5\n      8.3\n      0.2\n    \n    \n      std\n      99.2\n      83.0\n      49.1\n      4.5\n      4.5\n      0.9\n      14.9\n      14.6\n      1.8\n      34.7\n      ...\n      16.2\n      113.7\n      106.3\n      32.6\n      13.1\n      12.7\n      2.1\n      17.6\n      17.2\n      2.2\n    \n    \n      min\n      1.0\n      20240101.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      ...\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n    \n    \n      25%\n      31.0\n      20240123.0\n      51.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      13.0\n      ...\n      0.0\n      97.0\n      88.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n    \n    \n      50%\n      69.0\n      20240215.0\n      76.0\n      8.0\n      8.0\n      0.0\n      7.5\n      7.4\n      0.0\n      25.6\n      ...\n      0.0\n      148.1\n      136.8\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n    \n    \n      75%\n      117.0\n      20240309.0\n      104.0\n      8.0\n      8.0\n      0.0\n      16.0\n      16.0\n      0.0\n      44.8\n      ...\n      5.8\n      217.0\n      203.1\n      11.0\n      0.0\n      0.0\n      0.0\n      11.2\n      10.8\n      0.0\n    \n    \n      max\n      840.0\n      20240331.0\n      743.0\n      327.8\n      327.8\n      42.0\n      266.2\n      266.2\n      92.5\n      908.6\n      ...\n      454.0\n      1857.7\n      1573.1\n      694.3\n      452.0\n      279.0\n      280.5\n      395.6\n      395.6\n      128.9\n    \n  \n\n8 rows × 27 columns\n\n\n\n\n\nCode\nattributes = [\"Hrs_RN\", \"Hrs_LPN_ctr\", \"Hrs_CNA\", \"Hrs_NAtrn\", \"Hrs_MedAide\"]\nn = len(attributes)\n\nfig, axs = plt.subplots(n, n, figsize=(8, 8))\nscatter_matrix(\n    data[attributes].sample(200),\n    ax=axs, alpha=.7,\n    hist_kwds=dict(bins=15, linewidth=0)\n)\nfig.align_ylabels(axs[:, 0])\nfig.align_xlabels(axs[-1, :])\nfor ax in axs.flatten():\n    ax.tick_params(axis='both', which='both', length=3.5)\n\n# save_fig(\"scatter_matrix_plot\")\n\nplt.show()\n\n\n\n\n\n\n\n\nFigure 1: Scatter matrix of nursing worker working hours\n\n\n\n\n\n\n\nCode\nfrom great_tables import GT\n\ndf = data.loc[150000:, [\n    \"STATE\",\n    \"COUNTY_NAME\", \"COUNTY_FIPS\",\n    \"CITY\",\n    \"PROVNAME\", \"PROVNUM\",\n    # \"MDScensus\"\n]].value_counts().reset_index()\nGT(df.head(n=10))\n\n\n\n\n\n\n\n\n  STATE\n  COUNTY_NAME\n  COUNTY_FIPS\n  CITY\n  PROVNAME\n  PROVNUM\n  count\n\n\n\n  \n    CA\n    Alameda\n    1\n    ALAMEDA\n    ALAMEDA HEALTHCARE & WELLNESS CENTER\n    555486\n    91\n  \n  \n    OH\n    Mahoning\n    99\n    AUSTINTOWN\n    AVENTURA  AT HUMILITY HOUSE\n    366186\n    91\n  \n  \n    OH\n    Lucas\n    95\n    TOLEDO\n    OHIO LIVING SWAN CREEK\n    365996\n    91\n  \n  \n    OH\n    Lucas\n    95\n    TOLEDO\n    OTTERBEIN SUNSET HOUSE\n    366148\n    91\n  \n  \n    OH\n    Lucas\n    95\n    TOLEDO\n    PARK TERRACE NURSING AND REHABILITATION CENTER\n    365339\n    91\n  \n  \n    OH\n    Lucas\n    95\n    TOLEDO\n    POINT PLACE HEALTHCARE AND REHABILITATION CENTER\n    366039\n    91\n  \n  \n    OH\n    Lucas\n    95\n    WATERVILLE\n    ASTORIA PLACE OF WATERVILLE\n    365747\n    91\n  \n  \n    OH\n    Lucas\n    95\n    WATERVILLE\n    AYDEN HEALTHCARE OF WATERVILLE\n    365617\n    91\n  \n  \n    OH\n    Lucas\n    95\n    WHITEHOUSE\n    WHITEHOUSE COUNTRY MANOR\n    365756\n    91\n  \n  \n    OH\n    Madison\n    97\n    LONDON\n    LONDON HEALTH & REHAB CENTER\n    365241\n    91"
  },
  {
    "objectID": "notebooks/technical-snippets.html#some-gt-examples",
    "href": "notebooks/technical-snippets.html#some-gt-examples",
    "title": "Nurse Staffing Recommendations",
    "section": "Some GT examples",
    "text": "Some GT examples\n\n\nCode\nfrom typing import Any\nfrom IPython.display import display as ipy_display, HTML\nimport numpy as np\n\ndef display2(\n    *args,\n    globs: dict[str, Any] | None = None,\n    bold: bool = True,\n    width: str = \"400px\"  # Fixed width for each block\n) -&gt; None:\n    \"\"\"\n    Display an informative representation of multiple objects side-by-side in Jupyter.\n\n    Parameters\n    ----------\n    *args : tuple\n        Tuple of expressions to evaluate and display.\n    globs : dict[str, Any], default=None\n        Global namespace, to give eval() access to nonlocals passed by name.\n    bold : bool, default=True\n        Option to enable/disable string styling.\n    width : str, default=\"400px\"\n        Fixed width for each displayed block in the Jupyter notebook.\n\n    Warnings\n    --------\n    This function uses `eval()` to render expressions it receives\n    as strings. Access to variables in the global namespace is controlled\n    by `globs`. Take care to only pass trusted expressions to the function.\n    \"\"\"\n\n    if globs is None:\n        globs = {}\n\n    outputs = []\n    for arg in args:\n        name = f\"&lt;b&gt;{arg}&lt;/b&gt;\" if bold else arg\n        value = np.round(eval(arg, globs), 2)\n        shape = np.shape(value)\n        content = f\"&lt;div style='width:{width}; padding:10px; float:left;'&gt;&lt;pre&gt;{name}\\n--- {repr(shape)} ---\\n{repr(value)}&lt;/pre&gt;&lt;/div&gt;\"\n        outputs.append(content)\n\n    # Clearfix for layout\n    clearfix = \"&lt;div style='clear: both;'&gt;&lt;/div&gt;\"\n\n    # Display the HTML content in Jupyter\n    html_output = ''.join(outputs) + clearfix\n    ipy_display(HTML(html_output))\n\n    return None\n\n\n\n\nCode\nA = np.array([[1, 3], [2, 4]])\nx = np.array([[0, 1]])\n\ndisplay2(\n    \"A\", \"x.T\", \"np.dot(A, x.T)\", globs=globals(), bold=True, width=\"100px\"\n)\n\n\nA\n--- (2, 2) ---\narray([[1, 3],\n       [2, 4]])x.T\n--- (2, 1) ---\narray([[0],\n       [1]])np.dot(A, x.T)\n--- (2, 1) ---\narray([[3],\n       [4]])\n\n\n\n\nCode\ndisplay2(\n    \"data['STATE'].value_counts()\",\n    \"data['COUNTY_NAME'].value_counts()\",\n    \"data['CITY'].value_counts()\",\n    \"data['PROVNAME'].value_counts()\",\n    \"data['MDScensus'].value_counts()\",\n    width=\"340px\",\n    globs=globals()\n)\n\n\ndata['STATE'].value_counts()\n--- (52,) ---\nSTATE\nTX    105924\nCA    103740\nOH     83538\nFL     63245\nIL     61425\nPA     60515\nNY     54691\nIN     46501\nMO     44226\nMI     38402\nNC     37310\nIA     36036\nGA     31941\nNJ     31395\nMA     31122\nMN     30758\nWI     29484\nTN     27300\nKS     27118\nVA     26117\nOK     25116\nKY     24115\nLA     23751\nAL     20293\nMD     20020\nAR     19747\nCO     19110\nMS     18200\nCT     17836\nWA     17199\nSC     16835\nNE     16289\nAZ     12649\nOR     11557\nWV     11102\nUT      8918\nSD      8554\nME      7371\nID      7280\nND      6734\nRI      6643\nNH      6643\nNM      6006\nNV      5824\nMT      5369\nDE      3913\nHI      3731\nVT      3094\nWY      2912\nDC      1547\nAK      1365\nPR       455\nName: count, dtype: int64data['COUNTY_NAME'].value_counts()\n--- (1671,) ---\nCOUNTY_NAME\nLos Angeles    33124\nCook           18564\nMontgomery     16835\nJefferson      16471\nWashington     12831\n               ...  \nLanier            91\nTwiggs            91\nVinton            91\nBoundary          91\nRefugio           91\nName: count, Length: 1671, dtype: int64data['CITY'].value_counts()\n--- (5092,) ---\nCITY\nCHICAGO          7098\nLOS ANGELES      6916\nCINCINNATI       6279\nHOUSTON          5824\nSAN ANTONIO      5460\n                 ... \nLINCROFT           91\nWYCKOFF            91\nFLORHAM PARK       91\nNEW BRUNSWICK      91\nHORSESHOE BAY      91\nName: count, Length: 5092, dtype: int64data['PROVNAME'].value_counts()\n--- (14441,) ---\nPROVNAME\nMILLER'S MERRY MANOR                                  1092\nPARKVIEW CARE CENTER                                   455\nLITTLE SISTERS OF THE POOR                             455\nHERITAGE MANOR                                         273\nRIVERSIDE NURSING AND REHABILITATION CENTER            273\n                                                      ... \nMORGANFIELD NURSING AND REHABILITATION CENTER           91\nCAMPBELLSVILLE NURSING AND REHABILITATION CENTER        91\nFRANKLIN-SIMPSON NURSING AND REHABILITATION CENTER      91\nGRAND HAVEN NURSING HOME                                91\nTIERRA ESTE NURSING AND REHABILITATION CENTER           91\nName: count, Length: 14441, dtype: int64data['MDScensus'].value_counts()\n--- (635,) ---\nMDScensus\n56     15160\n57     15116\n58     15051\n55     14830\n53     14618\n       ...  \n622        1\n629        1\n730        1\n634        1\n617        1\nName: count, Length: 635, dtype: int64\n\n\n\n\nCode\ndata[[\"CY_Qtr\", \"WorkDate\", \"MDScensus\"]]\n\n\n\n\n\n  \n    \n      \n      CY_Qtr\n      WorkDate\n      MDScensus\n    \n  \n  \n    \n      0\n      2024Q1\n      20240101\n      50\n    \n    \n      1\n      2024Q1\n      20240102\n      49\n    \n    \n      2\n      2024Q1\n      20240103\n      49\n    \n    \n      3\n      2024Q1\n      20240104\n      50\n    \n    \n      4\n      2024Q1\n      20240105\n      51\n    \n    \n      ...\n      ...\n      ...\n      ...\n    \n    \n      1330961\n      2024Q1\n      20240327\n      81\n    \n    \n      1330962\n      2024Q1\n      20240328\n      83\n    \n    \n      1330963\n      2024Q1\n      20240329\n      85\n    \n    \n      1330964\n      2024Q1\n      20240330\n      82\n    \n    \n      1330965\n      2024Q1\n      20240331\n      82\n    \n  \n\n1330966 rows × 3 columns"
  },
  {
    "objectID": "notebooks/technical-snippets.html#sql",
    "href": "notebooks/technical-snippets.html#sql",
    "title": "Nurse Staffing Recommendations",
    "section": "SQL",
    "text": "SQL"
  },
  {
    "objectID": "notebooks/report.html",
    "href": "notebooks/report.html",
    "title": "Nurse Staffing Recommendations",
    "section": "",
    "text": "[…]"
  },
  {
    "objectID": "notebooks/report.html#imports",
    "href": "notebooks/report.html#imports",
    "title": "Nurse Staffing Recommendations",
    "section": "Imports",
    "text": "Imports\n\n\nCode\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom great_tables import GT\nfrom pandas.plotting import scatter_matrix\n\nfrom src.stylesheet import customize_plots\nfrom src.inspection import make_df, display"
  },
  {
    "objectID": "notebooks/report.html#the-dataset",
    "href": "notebooks/report.html#the-dataset",
    "title": "Nurse Staffing Recommendations",
    "section": "The dataset",
    "text": "The dataset\nWe begin by exploring the data to get to know the features and patterns on which we will base our analysis.\n\n\nCode\nif 'data' not in locals():\n    data = pd.read_csv(\n        \"../data/raw/PBJ_Daily_Nurse_Staffing_Q1_2024.zip\",\n        encoding='ISO-8859-1'\n    )\nelse:\n    print(\"data loaded.\")\n\n\n\n\nCode\ndata.sample(5)\n\n\n\n\n\n  \n    \n      \n      PROVNUM\n      PROVNAME\n      CITY\n      STATE\n      COUNTY_NAME\n      COUNTY_FIPS\n      CY_Qtr\n      WorkDate\n      MDScensus\n      Hrs_RNDON\n      ...\n      Hrs_LPN_ctr\n      Hrs_CNA\n      Hrs_CNA_emp\n      Hrs_CNA_ctr\n      Hrs_NAtrn\n      Hrs_NAtrn_emp\n      Hrs_NAtrn_ctr\n      Hrs_MedAide\n      Hrs_MedAide_emp\n      Hrs_MedAide_ctr\n    \n  \n  \n    \n      134826\n      075198\n      VILLAGE GREEN OF BRISTOL REHAB & HEALTH CENTER\n      FORESTVILLE\n      CT\n      Hartford\n      3\n      2024Q1\n      20240225\n      84\n      0.0\n      ...\n      0.00\n      129.16\n      129.16\n      0.00\n      11.63\n      11.63\n      0.0\n      0.00\n      0.00\n      0.0\n    \n    \n      314429\n      146128\n      PLYMOUTH PLACE\n      LA GRANGE PARK\n      IL\n      Cook\n      31\n      2024Q1\n      20240125\n      72\n      8.0\n      ...\n      0.00\n      183.59\n      183.59\n      0.00\n      0.00\n      0.00\n      0.0\n      0.00\n      0.00\n      0.0\n    \n    \n      649459\n      265607\n      CRYSTAL CREEK HEALTH AND REHABILITATION CENTER\n      FLORISSANT\n      MO\n      St. Louis\n      189\n      2024Q1\n      20240324\n      109\n      0.0\n      ...\n      0.00\n      149.00\n      149.00\n      0.00\n      0.00\n      0.00\n      0.0\n      50.25\n      50.25\n      0.0\n    \n    \n      992920\n      395640\n      JOHN J KANE REGIONAL CENTER-MC\n      MCKEESPORT\n      PA\n      Allegheny\n      3\n      2024Q1\n      20240120\n      198\n      0.0\n      ...\n      100.25\n      450.75\n      224.50\n      226.25\n      0.00\n      0.00\n      0.0\n      0.00\n      0.00\n      0.0\n    \n    \n      661170\n      265793\n      LA PLATA NURSING HOME\n      LA PLATA\n      MO\n      Macon\n      121\n      2024Q1\n      20240225\n      38\n      0.0\n      ...\n      0.00\n      83.33\n      83.33\n      0.00\n      11.75\n      11.75\n      0.0\n      14.38\n      14.38\n      0.0\n    \n  \n\n5 rows × 33 columns\n\n\n\n\n\nCode\n# TODO: pivot on day\n\ndata_pivoted = data.pivot_table(\n    index=\"STATE\",\n    columns=\"WorkDate\",\n    values=\"Hrs_RN\",\n    aggfunc='mean'\n)\n\n# Resetting the index for easier column access\n# data_pivoted.reset_index(inplace=True)\ndata_pivoted\n\n\n\n\n\n  \n    \n      WorkDate\n      20240101\n      20240102\n      20240103\n      20240104\n      20240105\n      20240106\n      20240107\n      20240108\n      20240109\n      20240110\n      ...\n      20240322\n      20240323\n      20240324\n      20240325\n      20240326\n      20240327\n      20240328\n      20240329\n      20240330\n      20240331\n    \n    \n      STATE\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n  \n    \n      AK\n      55.602000\n      51.898667\n      51.343333\n      59.512000\n      64.569333\n      58.176000\n      57.300000\n      60.578000\n      58.515333\n      59.689333\n      ...\n      62.525333\n      53.939333\n      57.629333\n      63.704000\n      63.604000\n      63.441333\n      65.700000\n      68.357333\n      54.641333\n      54.074000\n    \n    \n      AL\n      26.901570\n      39.632601\n      40.746816\n      40.160404\n      38.657937\n      26.692466\n      26.345874\n      38.713184\n      40.700897\n      41.691390\n      ...\n      38.314529\n      26.940000\n      26.800493\n      39.800852\n      41.089238\n      40.966502\n      39.004753\n      36.495605\n      27.455964\n      26.797085\n    \n    \n      AR\n      11.224470\n      12.514240\n      13.073456\n      13.465346\n      12.282304\n      12.595714\n      12.768341\n      13.161244\n      13.578756\n      13.734608\n      ...\n      13.382811\n      13.832995\n      13.381382\n      13.655576\n      13.879217\n      13.432074\n      14.206129\n      13.426175\n      13.525300\n      11.958571\n    \n    \n      AZ\n      33.938777\n      36.368273\n      37.029137\n      36.852158\n      36.982302\n      33.031655\n      31.628849\n      38.353525\n      38.457194\n      38.849496\n      ...\n      41.056331\n      34.905971\n      32.476691\n      40.276331\n      39.088633\n      40.678417\n      40.659353\n      39.422662\n      32.910216\n      31.528417\n    \n    \n      CA\n      29.643939\n      32.223912\n      32.686316\n      33.311368\n      32.586842\n      29.678272\n      29.393482\n      32.683263\n      33.510465\n      33.730807\n      ...\n      34.460474\n      31.168947\n      30.193833\n      33.812158\n      34.870868\n      34.675798\n      34.780860\n      33.950561\n      30.720272\n      29.810675\n    \n    \n      CO\n      37.223095\n      40.186095\n      40.631190\n      40.072571\n      40.423095\n      38.004381\n      37.096857\n      40.466143\n      40.956571\n      43.137571\n      ...\n      41.452905\n      38.295714\n      39.097857\n      43.101476\n      43.028905\n      41.711476\n      42.061190\n      40.556190\n      38.602524\n      38.213476\n    \n    \n      CT\n      35.593010\n      39.137245\n      40.845051\n      39.577806\n      38.820612\n      33.855204\n      34.137908\n      39.099490\n      40.483163\n      39.878827\n      ...\n      39.189592\n      33.277602\n      31.573061\n      38.741531\n      40.119184\n      39.543520\n      40.140561\n      36.694745\n      32.471837\n      31.387959\n    \n    \n      DC\n      76.412353\n      96.951176\n      92.495294\n      93.214118\n      94.737647\n      89.853529\n      79.513529\n      93.113529\n      102.617647\n      98.691176\n      ...\n      99.601765\n      92.243529\n      86.057647\n      94.458235\n      98.186471\n      92.970588\n      93.760000\n      88.358235\n      91.500588\n      76.418235\n    \n    \n      DE\n      48.073488\n      49.806977\n      52.222558\n      52.358140\n      50.613488\n      49.409535\n      48.332093\n      52.329767\n      55.013256\n      50.222791\n      ...\n      49.123721\n      51.508837\n      48.232326\n      47.708140\n      50.664651\n      51.872558\n      48.328140\n      47.305116\n      45.268372\n      42.826744\n    \n    \n      FL\n      44.208719\n      50.528245\n      51.586115\n      52.331007\n      51.401856\n      46.673655\n      45.565885\n      51.473655\n      53.545151\n      53.236964\n      ...\n      51.229914\n      48.472259\n      47.472763\n      52.853094\n      53.878158\n      53.967165\n      54.456302\n      51.843554\n      47.808043\n      46.299813\n    \n    \n      GA\n      18.511880\n      21.782165\n      22.803134\n      22.763162\n      22.722194\n      20.417037\n      20.057635\n      22.864302\n      23.227607\n      23.946068\n      ...\n      24.247806\n      22.377379\n      21.331966\n      24.187123\n      23.762023\n      24.624986\n      24.295670\n      22.414701\n      20.935271\n      20.027094\n    \n    \n      HI\n      70.109024\n      88.061707\n      89.378049\n      91.360000\n      90.813902\n      82.126829\n      74.779268\n      88.334146\n      89.205854\n      92.882439\n      ...\n      93.746585\n      81.097561\n      78.782195\n      95.884634\n      91.368780\n      95.997805\n      93.272927\n      89.069756\n      82.426341\n      76.437317\n    \n    \n      IA\n      22.838333\n      25.139621\n      25.236010\n      25.513889\n      25.689773\n      22.793131\n      22.964242\n      25.570581\n      25.039217\n      26.123813\n      ...\n      25.164596\n      23.802424\n      22.907020\n      25.947828\n      26.335581\n      26.775455\n      25.962475\n      24.953308\n      22.896490\n      22.409823\n    \n    \n      ID\n      24.325625\n      28.599875\n      30.391125\n      28.897375\n      28.103750\n      24.045875\n      23.750125\n      28.526000\n      28.961125\n      30.794750\n      ...\n      27.769750\n      22.179375\n      21.824125\n      28.623000\n      29.044000\n      30.715250\n      30.324500\n      28.523500\n      24.516375\n      23.193000\n    \n    \n      IL\n      40.518741\n      44.895289\n      45.480474\n      45.632133\n      45.581022\n      41.334370\n      40.201111\n      45.400563\n      45.447378\n      46.953244\n      ...\n      47.107763\n      42.229156\n      40.569941\n      47.162044\n      47.277807\n      47.474726\n      46.309956\n      47.338741\n      41.243615\n      38.754933\n    \n    \n      IN\n      25.732172\n      26.477378\n      26.469726\n      26.316282\n      26.849159\n      25.401272\n      25.668023\n      27.186947\n      26.782172\n      26.740294\n      ...\n      27.254795\n      25.644384\n      25.083816\n      27.937339\n      27.813249\n      27.635245\n      26.700900\n      26.755029\n      25.423033\n      24.693640\n    \n    \n      KS\n      20.998758\n      22.468557\n      21.725067\n      22.755403\n      21.948423\n      20.589765\n      21.222181\n      22.365369\n      21.057148\n      22.555738\n      ...\n      22.888289\n      21.562215\n      21.660872\n      22.672181\n      23.354430\n      23.047752\n      23.815570\n      21.909295\n      20.511711\n      21.205638\n    \n    \n      KY\n      30.264755\n      33.232981\n      33.452453\n      32.860830\n      32.436604\n      31.494491\n      30.550566\n      33.331434\n      33.687321\n      33.299925\n      ...\n      33.258830\n      30.906906\n      30.522264\n      34.141698\n      34.794868\n      34.302491\n      33.599132\n      32.082981\n      31.581585\n      30.353472\n    \n    \n      LA\n      9.650920\n      10.003793\n      10.045670\n      9.992261\n      9.947931\n      10.447778\n      10.562222\n      9.285556\n      9.646015\n      9.772605\n      ...\n      10.842529\n      10.900536\n      10.620383\n      10.169885\n      10.666207\n      10.960575\n      10.225441\n      9.383602\n      11.024904\n      10.359080\n    \n    \n      MA\n      39.254503\n      38.644211\n      38.419620\n      39.251901\n      39.735731\n      37.411550\n      36.665439\n      38.615702\n      40.270848\n      39.968743\n      ...\n      37.619327\n      37.945175\n      37.180029\n      38.855439\n      39.771871\n      39.055585\n      39.775117\n      37.979064\n      36.909591\n      35.394269\n    \n    \n      MD\n      48.480909\n      53.835227\n      54.747364\n      55.366591\n      54.434455\n      51.844227\n      48.868091\n      53.992182\n      52.681773\n      54.975500\n      ...\n      54.698136\n      52.541818\n      50.319909\n      51.897545\n      53.571273\n      53.860591\n      52.873409\n      51.027364\n      51.012364\n      46.693727\n    \n    \n      ME\n      44.605679\n      52.675309\n      53.210000\n      52.965062\n      51.634815\n      44.355556\n      41.703951\n      51.504198\n      52.985556\n      55.204691\n      ...\n      48.337037\n      41.466420\n      41.231235\n      49.511975\n      53.554568\n      52.495556\n      50.995802\n      49.387284\n      41.715309\n      38.399012\n    \n    \n      MI\n      31.840403\n      35.916919\n      37.510735\n      37.633555\n      36.627038\n      32.023081\n      31.603744\n      37.168246\n      37.636659\n      38.506374\n      ...\n      37.415711\n      31.798578\n      31.736635\n      36.540000\n      37.735261\n      38.089076\n      37.717820\n      36.175047\n      32.036730\n      31.153649\n    \n    \n      MN\n      35.033314\n      41.024763\n      42.313580\n      41.688905\n      41.074527\n      35.065059\n      35.787574\n      41.939527\n      41.977041\n      42.187899\n      ...\n      42.760355\n      36.127544\n      35.741124\n      42.164408\n      44.007663\n      44.367130\n      44.285651\n      41.874822\n      36.725976\n      35.565917\n    \n    \n      MO\n      15.788498\n      17.543992\n      17.468642\n      17.357160\n      16.954444\n      17.107634\n      16.576749\n      16.787160\n      18.045782\n      18.238128\n      ...\n      17.214198\n      16.847510\n      17.005103\n      17.233601\n      17.648663\n      18.301152\n      18.063765\n      17.021029\n      16.695535\n      16.083642\n    \n    \n      MS\n      20.827300\n      27.172750\n      28.003300\n      28.498150\n      27.329850\n      20.201300\n      20.731500\n      27.697700\n      28.925200\n      29.731550\n      ...\n      28.730550\n      21.192800\n      21.478200\n      29.157300\n      28.901850\n      29.581950\n      29.549300\n      26.510700\n      19.974450\n      18.968100\n    \n    \n      MT\n      28.274407\n      34.167458\n      34.420000\n      34.653898\n      33.428814\n      29.468983\n      31.083729\n      37.317458\n      36.488136\n      35.959153\n      ...\n      33.908475\n      30.398305\n      30.253898\n      36.602203\n      38.875763\n      36.122203\n      34.598475\n      34.552712\n      30.409492\n      29.599831\n    \n    \n      NC\n      22.247976\n      24.949341\n      26.265512\n      25.999024\n      25.496902\n      23.229317\n      22.181122\n      25.546537\n      25.902829\n      26.529268\n      ...\n      27.260585\n      23.662317\n      22.993244\n      26.488732\n      26.931488\n      26.507659\n      26.110000\n      25.758000\n      22.889122\n      22.017049\n    \n    \n      ND\n      31.860270\n      38.348243\n      40.633378\n      38.023243\n      35.265811\n      31.280405\n      32.373243\n      39.425676\n      39.420270\n      39.784459\n      ...\n      37.855811\n      31.349595\n      31.869730\n      39.188514\n      39.367568\n      39.229189\n      37.719865\n      34.812432\n      30.955676\n      30.993243\n    \n    \n      NE\n      23.365419\n      25.272235\n      24.100279\n      25.115196\n      23.302626\n      24.454190\n      23.630559\n      24.344693\n      23.463240\n      25.403911\n      ...\n      23.552905\n      24.252905\n      23.816480\n      25.028380\n      25.604916\n      25.195363\n      24.540056\n      23.927542\n      24.645307\n      23.921620\n    \n    \n      NH\n      36.059041\n      41.363151\n      44.759589\n      44.145205\n      41.795479\n      32.758630\n      32.066301\n      40.983425\n      44.204932\n      41.722329\n      ...\n      42.447808\n      35.066164\n      34.268630\n      41.997260\n      42.030000\n      44.547123\n      47.387260\n      44.094521\n      33.299863\n      32.937534\n    \n    \n      NJ\n      42.600754\n      48.751014\n      50.149623\n      50.088000\n      48.413246\n      45.385159\n      43.822783\n      48.486754\n      48.916783\n      49.859275\n      ...\n      49.296638\n      45.939188\n      43.943304\n      48.825072\n      50.997246\n      50.196638\n      49.631855\n      47.144377\n      44.858232\n      42.703942\n    \n    \n      NM\n      33.375758\n      36.692727\n      37.505909\n      35.649697\n      37.853939\n      34.315455\n      34.202727\n      38.273182\n      38.841818\n      37.853182\n      ...\n      38.443636\n      36.525606\n      36.071212\n      39.288485\n      39.542727\n      37.958939\n      38.241212\n      37.816364\n      34.915758\n      34.398788\n    \n    \n      NV\n      41.530625\n      45.082813\n      46.118125\n      46.608438\n      46.916875\n      41.337812\n      42.300156\n      47.543750\n      47.189531\n      47.128906\n      ...\n      50.780313\n      46.901250\n      45.053906\n      48.429688\n      50.456406\n      49.255469\n      49.613906\n      52.946719\n      45.201250\n      41.933594\n    \n    \n      NY\n      63.037970\n      83.355557\n      87.962745\n      87.876689\n      85.887238\n      63.016772\n      59.786040\n      86.420782\n      88.668419\n      89.539917\n      ...\n      87.225824\n      63.389218\n      60.537787\n      86.742646\n      90.201764\n      89.666972\n      87.925940\n      83.728253\n      63.175507\n      59.169018\n    \n    \n      OH\n      24.006580\n      26.962200\n      27.150054\n      26.666503\n      26.430294\n      24.175632\n      24.283965\n      27.093192\n      27.466035\n      27.726634\n      ...\n      27.942298\n      25.253976\n      25.000142\n      27.565142\n      28.322538\n      27.940294\n      26.981373\n      26.369423\n      24.751939\n      24.371797\n    \n    \n      OK\n      10.247391\n      10.938406\n      10.680000\n      11.024094\n      11.159855\n      13.248297\n      12.748007\n      10.697790\n      11.148551\n      11.108478\n      ...\n      10.873188\n      13.280797\n      13.058768\n      11.140942\n      12.103551\n      11.680000\n      11.218949\n      11.324964\n      14.275652\n      13.919058\n    \n    \n      OR\n      18.993307\n      21.867244\n      21.657795\n      21.835591\n      20.673386\n      18.534331\n      18.504488\n      21.327953\n      21.789921\n      22.587087\n      ...\n      21.738583\n      19.176457\n      19.684331\n      21.581496\n      20.215039\n      21.213465\n      22.737165\n      20.783780\n      19.890394\n      18.842835\n    \n    \n      PA\n      42.059970\n      46.567113\n      47.094617\n      47.600286\n      46.890782\n      41.861233\n      40.447368\n      47.176165\n      48.155910\n      48.193835\n      ...\n      48.677895\n      43.529474\n      42.168256\n      48.857624\n      49.355835\n      49.345744\n      49.219534\n      46.220030\n      41.910677\n      40.328812\n    \n    \n      PR\n      49.450000\n      67.460000\n      63.000000\n      67.940000\n      59.160000\n      51.060000\n      45.510000\n      62.410000\n      64.350000\n      60.830000\n      ...\n      63.300000\n      58.020000\n      51.220000\n      66.340000\n      66.700000\n      58.670000\n      73.580000\n      60.520000\n      56.920000\n      46.660000\n    \n    \n      RI\n      45.887260\n      54.173151\n      53.897808\n      52.802603\n      51.161370\n      44.001781\n      43.298767\n      51.065205\n      51.492603\n      54.292055\n      ...\n      54.486986\n      46.774658\n      44.722740\n      51.855342\n      59.626712\n      56.186164\n      57.319726\n      52.652877\n      44.697808\n      44.168219\n    \n    \n      SC\n      26.868649\n      30.011297\n      30.351351\n      31.029351\n      31.282432\n      26.417027\n      25.796703\n      32.142486\n      31.716811\n      31.473135\n      ...\n      32.768108\n      27.239946\n      26.613622\n      32.162054\n      33.461027\n      32.779622\n      33.697189\n      31.534378\n      26.205838\n      26.416270\n    \n    \n      SD\n      23.937872\n      27.887021\n      28.650957\n      28.709362\n      25.869787\n      23.294362\n      23.468936\n      26.565426\n      27.689362\n      28.507979\n      ...\n      27.204468\n      24.379681\n      24.976383\n      28.903298\n      27.910106\n      28.876596\n      29.154362\n      25.915426\n      23.493617\n      23.390851\n    \n    \n      TN\n      25.497533\n      28.158567\n      28.439533\n      29.564267\n      28.117767\n      25.960967\n      25.285133\n      28.508100\n      29.937000\n      30.364300\n      ...\n      27.939400\n      25.935067\n      25.294100\n      29.386033\n      29.668300\n      29.138300\n      29.023500\n      27.571300\n      25.624767\n      25.035000\n    \n    \n      TX\n      15.509923\n      16.095541\n      16.479777\n      16.861229\n      16.301117\n      18.420490\n      17.912766\n      16.624863\n      16.983634\n      16.666486\n      ...\n      17.127612\n      19.585756\n      19.274991\n      17.441134\n      17.478565\n      17.839192\n      17.482801\n      17.273505\n      19.546521\n      18.477354\n    \n    \n      UT\n      40.377143\n      45.121837\n      46.036122\n      46.057347\n      45.367347\n      40.556531\n      39.558571\n      45.473878\n      46.693673\n      46.937857\n      ...\n      46.381735\n      43.381939\n      41.842755\n      47.288776\n      49.215102\n      47.684286\n      47.572245\n      44.711735\n      40.650816\n      38.821735\n    \n    \n      VA\n      27.820523\n      29.123484\n      29.978780\n      30.093240\n      30.922822\n      27.202439\n      27.001533\n      29.502265\n      29.475575\n      30.275923\n      ...\n      32.296028\n      28.278362\n      26.743066\n      31.306899\n      32.950209\n      32.211638\n      31.160836\n      30.319443\n      29.397491\n      28.079443\n    \n    \n      VT\n      34.996176\n      47.094118\n      47.409118\n      46.076176\n      44.170588\n      33.863824\n      35.785000\n      43.345882\n      43.502353\n      44.892059\n      ...\n      40.041765\n      33.454706\n      32.431765\n      43.552647\n      44.873824\n      45.265588\n      44.974706\n      43.513235\n      34.146471\n      31.770294\n    \n    \n      WA\n      40.340265\n      43.959630\n      44.146349\n      45.627725\n      44.312328\n      38.637831\n      38.580370\n      43.357672\n      45.285503\n      44.805397\n      ...\n      43.901429\n      39.084603\n      38.106349\n      43.540265\n      43.917037\n      44.294339\n      45.304021\n      43.859894\n      38.895344\n      36.047619\n    \n    \n      WI\n      31.700062\n      34.592870\n      35.048611\n      34.292222\n      35.131759\n      31.044475\n      30.880710\n      33.966605\n      34.670494\n      36.419074\n      ...\n      33.826481\n      31.124568\n      31.288025\n      34.194537\n      36.365957\n      36.249784\n      34.550586\n      33.599722\n      31.473148\n      31.153951\n    \n    \n      WV\n      20.471230\n      33.144754\n      34.094262\n      32.715246\n      31.868033\n      22.048525\n      21.155082\n      32.295984\n      33.005820\n      33.247295\n      ...\n      31.105082\n      22.139098\n      21.513443\n      30.750738\n      33.134016\n      33.936393\n      31.578934\n      29.795328\n      21.780984\n      20.225246\n    \n    \n      WY\n      36.964062\n      36.274062\n      37.367500\n      37.316563\n      36.533750\n      30.890000\n      35.560625\n      41.456250\n      39.648750\n      39.137188\n      ...\n      38.049062\n      33.010625\n      34.812812\n      38.780938\n      40.523125\n      37.850625\n      36.653750\n      34.769375\n      31.446250\n      32.068438\n    \n  \n\n52 rows × 91 columns\n\n\n\n\n\nCode\ndata_pivoted.iloc[:, 1:]\n\n\n\n\n\n  \n    \n      WorkDate\n      20240102\n      20240103\n      20240104\n      20240105\n      20240106\n      20240107\n      20240108\n      20240109\n      20240110\n      20240111\n      ...\n      20240322\n      20240323\n      20240324\n      20240325\n      20240326\n      20240327\n      20240328\n      20240329\n      20240330\n      20240331\n    \n    \n      STATE\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n  \n    \n      AK\n      51.898667\n      51.343333\n      59.512000\n      64.569333\n      58.176000\n      57.300000\n      60.578000\n      58.515333\n      59.689333\n      60.191333\n      ...\n      62.525333\n      53.939333\n      57.629333\n      63.704000\n      63.604000\n      63.441333\n      65.700000\n      68.357333\n      54.641333\n      54.074000\n    \n    \n      AL\n      39.632601\n      40.746816\n      40.160404\n      38.657937\n      26.692466\n      26.345874\n      38.713184\n      40.700897\n      41.691390\n      41.597578\n      ...\n      38.314529\n      26.940000\n      26.800493\n      39.800852\n      41.089238\n      40.966502\n      39.004753\n      36.495605\n      27.455964\n      26.797085\n    \n    \n      AR\n      12.514240\n      13.073456\n      13.465346\n      12.282304\n      12.595714\n      12.768341\n      13.161244\n      13.578756\n      13.734608\n      14.105069\n      ...\n      13.382811\n      13.832995\n      13.381382\n      13.655576\n      13.879217\n      13.432074\n      14.206129\n      13.426175\n      13.525300\n      11.958571\n    \n    \n      AZ\n      36.368273\n      37.029137\n      36.852158\n      36.982302\n      33.031655\n      31.628849\n      38.353525\n      38.457194\n      38.849496\n      37.948273\n      ...\n      41.056331\n      34.905971\n      32.476691\n      40.276331\n      39.088633\n      40.678417\n      40.659353\n      39.422662\n      32.910216\n      31.528417\n    \n    \n      CA\n      32.223912\n      32.686316\n      33.311368\n      32.586842\n      29.678272\n      29.393482\n      32.683263\n      33.510465\n      33.730807\n      33.616746\n      ...\n      34.460474\n      31.168947\n      30.193833\n      33.812158\n      34.870868\n      34.675798\n      34.780860\n      33.950561\n      30.720272\n      29.810675\n    \n    \n      CO\n      40.186095\n      40.631190\n      40.072571\n      40.423095\n      38.004381\n      37.096857\n      40.466143\n      40.956571\n      43.137571\n      42.541476\n      ...\n      41.452905\n      38.295714\n      39.097857\n      43.101476\n      43.028905\n      41.711476\n      42.061190\n      40.556190\n      38.602524\n      38.213476\n    \n    \n      CT\n      39.137245\n      40.845051\n      39.577806\n      38.820612\n      33.855204\n      34.137908\n      39.099490\n      40.483163\n      39.878827\n      40.956990\n      ...\n      39.189592\n      33.277602\n      31.573061\n      38.741531\n      40.119184\n      39.543520\n      40.140561\n      36.694745\n      32.471837\n      31.387959\n    \n    \n      DC\n      96.951176\n      92.495294\n      93.214118\n      94.737647\n      89.853529\n      79.513529\n      93.113529\n      102.617647\n      98.691176\n      99.465882\n      ...\n      99.601765\n      92.243529\n      86.057647\n      94.458235\n      98.186471\n      92.970588\n      93.760000\n      88.358235\n      91.500588\n      76.418235\n    \n    \n      DE\n      49.806977\n      52.222558\n      52.358140\n      50.613488\n      49.409535\n      48.332093\n      52.329767\n      55.013256\n      50.222791\n      52.626047\n      ...\n      49.123721\n      51.508837\n      48.232326\n      47.708140\n      50.664651\n      51.872558\n      48.328140\n      47.305116\n      45.268372\n      42.826744\n    \n    \n      FL\n      50.528245\n      51.586115\n      52.331007\n      51.401856\n      46.673655\n      45.565885\n      51.473655\n      53.545151\n      53.236964\n      53.812101\n      ...\n      51.229914\n      48.472259\n      47.472763\n      52.853094\n      53.878158\n      53.967165\n      54.456302\n      51.843554\n      47.808043\n      46.299813\n    \n    \n      GA\n      21.782165\n      22.803134\n      22.763162\n      22.722194\n      20.417037\n      20.057635\n      22.864302\n      23.227607\n      23.946068\n      23.938661\n      ...\n      24.247806\n      22.377379\n      21.331966\n      24.187123\n      23.762023\n      24.624986\n      24.295670\n      22.414701\n      20.935271\n      20.027094\n    \n    \n      HI\n      88.061707\n      89.378049\n      91.360000\n      90.813902\n      82.126829\n      74.779268\n      88.334146\n      89.205854\n      92.882439\n      92.818293\n      ...\n      93.746585\n      81.097561\n      78.782195\n      95.884634\n      91.368780\n      95.997805\n      93.272927\n      89.069756\n      82.426341\n      76.437317\n    \n    \n      IA\n      25.139621\n      25.236010\n      25.513889\n      25.689773\n      22.793131\n      22.964242\n      25.570581\n      25.039217\n      26.123813\n      25.783359\n      ...\n      25.164596\n      23.802424\n      22.907020\n      25.947828\n      26.335581\n      26.775455\n      25.962475\n      24.953308\n      22.896490\n      22.409823\n    \n    \n      ID\n      28.599875\n      30.391125\n      28.897375\n      28.103750\n      24.045875\n      23.750125\n      28.526000\n      28.961125\n      30.794750\n      28.783375\n      ...\n      27.769750\n      22.179375\n      21.824125\n      28.623000\n      29.044000\n      30.715250\n      30.324500\n      28.523500\n      24.516375\n      23.193000\n    \n    \n      IL\n      44.895289\n      45.480474\n      45.632133\n      45.581022\n      41.334370\n      40.201111\n      45.400563\n      45.447378\n      46.953244\n      46.710637\n      ...\n      47.107763\n      42.229156\n      40.569941\n      47.162044\n      47.277807\n      47.474726\n      46.309956\n      47.338741\n      41.243615\n      38.754933\n    \n    \n      IN\n      26.477378\n      26.469726\n      26.316282\n      26.849159\n      25.401272\n      25.668023\n      27.186947\n      26.782172\n      26.740294\n      27.403601\n      ...\n      27.254795\n      25.644384\n      25.083816\n      27.937339\n      27.813249\n      27.635245\n      26.700900\n      26.755029\n      25.423033\n      24.693640\n    \n    \n      KS\n      22.468557\n      21.725067\n      22.755403\n      21.948423\n      20.589765\n      21.222181\n      22.365369\n      21.057148\n      22.555738\n      22.512349\n      ...\n      22.888289\n      21.562215\n      21.660872\n      22.672181\n      23.354430\n      23.047752\n      23.815570\n      21.909295\n      20.511711\n      21.205638\n    \n    \n      KY\n      33.232981\n      33.452453\n      32.860830\n      32.436604\n      31.494491\n      30.550566\n      33.331434\n      33.687321\n      33.299925\n      33.754943\n      ...\n      33.258830\n      30.906906\n      30.522264\n      34.141698\n      34.794868\n      34.302491\n      33.599132\n      32.082981\n      31.581585\n      30.353472\n    \n    \n      LA\n      10.003793\n      10.045670\n      9.992261\n      9.947931\n      10.447778\n      10.562222\n      9.285556\n      9.646015\n      9.772605\n      10.311494\n      ...\n      10.842529\n      10.900536\n      10.620383\n      10.169885\n      10.666207\n      10.960575\n      10.225441\n      9.383602\n      11.024904\n      10.359080\n    \n    \n      MA\n      38.644211\n      38.419620\n      39.251901\n      39.735731\n      37.411550\n      36.665439\n      38.615702\n      40.270848\n      39.968743\n      38.243509\n      ...\n      37.619327\n      37.945175\n      37.180029\n      38.855439\n      39.771871\n      39.055585\n      39.775117\n      37.979064\n      36.909591\n      35.394269\n    \n    \n      MD\n      53.835227\n      54.747364\n      55.366591\n      54.434455\n      51.844227\n      48.868091\n      53.992182\n      52.681773\n      54.975500\n      55.072318\n      ...\n      54.698136\n      52.541818\n      50.319909\n      51.897545\n      53.571273\n      53.860591\n      52.873409\n      51.027364\n      51.012364\n      46.693727\n    \n    \n      ME\n      52.675309\n      53.210000\n      52.965062\n      51.634815\n      44.355556\n      41.703951\n      51.504198\n      52.985556\n      55.204691\n      54.661605\n      ...\n      48.337037\n      41.466420\n      41.231235\n      49.511975\n      53.554568\n      52.495556\n      50.995802\n      49.387284\n      41.715309\n      38.399012\n    \n    \n      MI\n      35.916919\n      37.510735\n      37.633555\n      36.627038\n      32.023081\n      31.603744\n      37.168246\n      37.636659\n      38.506374\n      37.041777\n      ...\n      37.415711\n      31.798578\n      31.736635\n      36.540000\n      37.735261\n      38.089076\n      37.717820\n      36.175047\n      32.036730\n      31.153649\n    \n    \n      MN\n      41.024763\n      42.313580\n      41.688905\n      41.074527\n      35.065059\n      35.787574\n      41.939527\n      41.977041\n      42.187899\n      41.705947\n      ...\n      42.760355\n      36.127544\n      35.741124\n      42.164408\n      44.007663\n      44.367130\n      44.285651\n      41.874822\n      36.725976\n      35.565917\n    \n    \n      MO\n      17.543992\n      17.468642\n      17.357160\n      16.954444\n      17.107634\n      16.576749\n      16.787160\n      18.045782\n      18.238128\n      18.421008\n      ...\n      17.214198\n      16.847510\n      17.005103\n      17.233601\n      17.648663\n      18.301152\n      18.063765\n      17.021029\n      16.695535\n      16.083642\n    \n    \n      MS\n      27.172750\n      28.003300\n      28.498150\n      27.329850\n      20.201300\n      20.731500\n      27.697700\n      28.925200\n      29.731550\n      28.892000\n      ...\n      28.730550\n      21.192800\n      21.478200\n      29.157300\n      28.901850\n      29.581950\n      29.549300\n      26.510700\n      19.974450\n      18.968100\n    \n    \n      MT\n      34.167458\n      34.420000\n      34.653898\n      33.428814\n      29.468983\n      31.083729\n      37.317458\n      36.488136\n      35.959153\n      35.653898\n      ...\n      33.908475\n      30.398305\n      30.253898\n      36.602203\n      38.875763\n      36.122203\n      34.598475\n      34.552712\n      30.409492\n      29.599831\n    \n    \n      NC\n      24.949341\n      26.265512\n      25.999024\n      25.496902\n      23.229317\n      22.181122\n      25.546537\n      25.902829\n      26.529268\n      27.181805\n      ...\n      27.260585\n      23.662317\n      22.993244\n      26.488732\n      26.931488\n      26.507659\n      26.110000\n      25.758000\n      22.889122\n      22.017049\n    \n    \n      ND\n      38.348243\n      40.633378\n      38.023243\n      35.265811\n      31.280405\n      32.373243\n      39.425676\n      39.420270\n      39.784459\n      39.696622\n      ...\n      37.855811\n      31.349595\n      31.869730\n      39.188514\n      39.367568\n      39.229189\n      37.719865\n      34.812432\n      30.955676\n      30.993243\n    \n    \n      NE\n      25.272235\n      24.100279\n      25.115196\n      23.302626\n      24.454190\n      23.630559\n      24.344693\n      23.463240\n      25.403911\n      24.793240\n      ...\n      23.552905\n      24.252905\n      23.816480\n      25.028380\n      25.604916\n      25.195363\n      24.540056\n      23.927542\n      24.645307\n      23.921620\n    \n    \n      NH\n      41.363151\n      44.759589\n      44.145205\n      41.795479\n      32.758630\n      32.066301\n      40.983425\n      44.204932\n      41.722329\n      43.894110\n      ...\n      42.447808\n      35.066164\n      34.268630\n      41.997260\n      42.030000\n      44.547123\n      47.387260\n      44.094521\n      33.299863\n      32.937534\n    \n    \n      NJ\n      48.751014\n      50.149623\n      50.088000\n      48.413246\n      45.385159\n      43.822783\n      48.486754\n      48.916783\n      49.859275\n      49.887913\n      ...\n      49.296638\n      45.939188\n      43.943304\n      48.825072\n      50.997246\n      50.196638\n      49.631855\n      47.144377\n      44.858232\n      42.703942\n    \n    \n      NM\n      36.692727\n      37.505909\n      35.649697\n      37.853939\n      34.315455\n      34.202727\n      38.273182\n      38.841818\n      37.853182\n      36.688788\n      ...\n      38.443636\n      36.525606\n      36.071212\n      39.288485\n      39.542727\n      37.958939\n      38.241212\n      37.816364\n      34.915758\n      34.398788\n    \n    \n      NV\n      45.082813\n      46.118125\n      46.608438\n      46.916875\n      41.337812\n      42.300156\n      47.543750\n      47.189531\n      47.128906\n      45.106406\n      ...\n      50.780313\n      46.901250\n      45.053906\n      48.429688\n      50.456406\n      49.255469\n      49.613906\n      52.946719\n      45.201250\n      41.933594\n    \n    \n      NY\n      83.355557\n      87.962745\n      87.876689\n      85.887238\n      63.016772\n      59.786040\n      86.420782\n      88.668419\n      89.539917\n      88.716023\n      ...\n      87.225824\n      63.389218\n      60.537787\n      86.742646\n      90.201764\n      89.666972\n      87.925940\n      83.728253\n      63.175507\n      59.169018\n    \n    \n      OH\n      26.962200\n      27.150054\n      26.666503\n      26.430294\n      24.175632\n      24.283965\n      27.093192\n      27.466035\n      27.726634\n      27.265294\n      ...\n      27.942298\n      25.253976\n      25.000142\n      27.565142\n      28.322538\n      27.940294\n      26.981373\n      26.369423\n      24.751939\n      24.371797\n    \n    \n      OK\n      10.938406\n      10.680000\n      11.024094\n      11.159855\n      13.248297\n      12.748007\n      10.697790\n      11.148551\n      11.108478\n      11.260290\n      ...\n      10.873188\n      13.280797\n      13.058768\n      11.140942\n      12.103551\n      11.680000\n      11.218949\n      11.324964\n      14.275652\n      13.919058\n    \n    \n      OR\n      21.867244\n      21.657795\n      21.835591\n      20.673386\n      18.534331\n      18.504488\n      21.327953\n      21.789921\n      22.587087\n      22.416850\n      ...\n      21.738583\n      19.176457\n      19.684331\n      21.581496\n      20.215039\n      21.213465\n      22.737165\n      20.783780\n      19.890394\n      18.842835\n    \n    \n      PA\n      46.567113\n      47.094617\n      47.600286\n      46.890782\n      41.861233\n      40.447368\n      47.176165\n      48.155910\n      48.193835\n      48.581278\n      ...\n      48.677895\n      43.529474\n      42.168256\n      48.857624\n      49.355835\n      49.345744\n      49.219534\n      46.220030\n      41.910677\n      40.328812\n    \n    \n      PR\n      67.460000\n      63.000000\n      67.940000\n      59.160000\n      51.060000\n      45.510000\n      62.410000\n      64.350000\n      60.830000\n      70.630000\n      ...\n      63.300000\n      58.020000\n      51.220000\n      66.340000\n      66.700000\n      58.670000\n      73.580000\n      60.520000\n      56.920000\n      46.660000\n    \n    \n      RI\n      54.173151\n      53.897808\n      52.802603\n      51.161370\n      44.001781\n      43.298767\n      51.065205\n      51.492603\n      54.292055\n      54.977534\n      ...\n      54.486986\n      46.774658\n      44.722740\n      51.855342\n      59.626712\n      56.186164\n      57.319726\n      52.652877\n      44.697808\n      44.168219\n    \n    \n      SC\n      30.011297\n      30.351351\n      31.029351\n      31.282432\n      26.417027\n      25.796703\n      32.142486\n      31.716811\n      31.473135\n      31.948324\n      ...\n      32.768108\n      27.239946\n      26.613622\n      32.162054\n      33.461027\n      32.779622\n      33.697189\n      31.534378\n      26.205838\n      26.416270\n    \n    \n      SD\n      27.887021\n      28.650957\n      28.709362\n      25.869787\n      23.294362\n      23.468936\n      26.565426\n      27.689362\n      28.507979\n      27.502234\n      ...\n      27.204468\n      24.379681\n      24.976383\n      28.903298\n      27.910106\n      28.876596\n      29.154362\n      25.915426\n      23.493617\n      23.390851\n    \n    \n      TN\n      28.158567\n      28.439533\n      29.564267\n      28.117767\n      25.960967\n      25.285133\n      28.508100\n      29.937000\n      30.364300\n      29.514267\n      ...\n      27.939400\n      25.935067\n      25.294100\n      29.386033\n      29.668300\n      29.138300\n      29.023500\n      27.571300\n      25.624767\n      25.035000\n    \n    \n      TX\n      16.095541\n      16.479777\n      16.861229\n      16.301117\n      18.420490\n      17.912766\n      16.624863\n      16.983634\n      16.666486\n      16.601770\n      ...\n      17.127612\n      19.585756\n      19.274991\n      17.441134\n      17.478565\n      17.839192\n      17.482801\n      17.273505\n      19.546521\n      18.477354\n    \n    \n      UT\n      45.121837\n      46.036122\n      46.057347\n      45.367347\n      40.556531\n      39.558571\n      45.473878\n      46.693673\n      46.937857\n      47.847551\n      ...\n      46.381735\n      43.381939\n      41.842755\n      47.288776\n      49.215102\n      47.684286\n      47.572245\n      44.711735\n      40.650816\n      38.821735\n    \n    \n      VA\n      29.123484\n      29.978780\n      30.093240\n      30.922822\n      27.202439\n      27.001533\n      29.502265\n      29.475575\n      30.275923\n      31.851882\n      ...\n      32.296028\n      28.278362\n      26.743066\n      31.306899\n      32.950209\n      32.211638\n      31.160836\n      30.319443\n      29.397491\n      28.079443\n    \n    \n      VT\n      47.094118\n      47.409118\n      46.076176\n      44.170588\n      33.863824\n      35.785000\n      43.345882\n      43.502353\n      44.892059\n      46.311176\n      ...\n      40.041765\n      33.454706\n      32.431765\n      43.552647\n      44.873824\n      45.265588\n      44.974706\n      43.513235\n      34.146471\n      31.770294\n    \n    \n      WA\n      43.959630\n      44.146349\n      45.627725\n      44.312328\n      38.637831\n      38.580370\n      43.357672\n      45.285503\n      44.805397\n      44.765397\n      ...\n      43.901429\n      39.084603\n      38.106349\n      43.540265\n      43.917037\n      44.294339\n      45.304021\n      43.859894\n      38.895344\n      36.047619\n    \n    \n      WI\n      34.592870\n      35.048611\n      34.292222\n      35.131759\n      31.044475\n      30.880710\n      33.966605\n      34.670494\n      36.419074\n      35.209352\n      ...\n      33.826481\n      31.124568\n      31.288025\n      34.194537\n      36.365957\n      36.249784\n      34.550586\n      33.599722\n      31.473148\n      31.153951\n    \n    \n      WV\n      33.144754\n      34.094262\n      32.715246\n      31.868033\n      22.048525\n      21.155082\n      32.295984\n      33.005820\n      33.247295\n      33.723689\n      ...\n      31.105082\n      22.139098\n      21.513443\n      30.750738\n      33.134016\n      33.936393\n      31.578934\n      29.795328\n      21.780984\n      20.225246\n    \n    \n      WY\n      36.274062\n      37.367500\n      37.316563\n      36.533750\n      30.890000\n      35.560625\n      41.456250\n      39.648750\n      39.137188\n      34.996875\n      ...\n      38.049062\n      33.010625\n      34.812812\n      38.780938\n      40.523125\n      37.850625\n      36.653750\n      34.769375\n      31.446250\n      32.068438\n    \n  \n\n52 rows × 90 columns\n\n\n\n\n\nCode\n# (\n#     GT(data_pivoted, rowname_col=\"STATE\")\n#     .fmt_nanoplot(\n#         columns=data_pivoted.columns[1:],\n#         reference_line=\"mean\",\n#         reference_area=[\"min\", \"q1\"]\n#     )\n#     .fmt_nanoplot(\n#         columns=data_pivoted.columns[1:],\n#         plot_type=\"bar\",\n#         reference_line=\"max\",\n#         reference_area=[\"max\", \"median\"]\n#     )\n# )\n\n\n\n\nCode\ndata.describe().round(1)\n# display(Markdown(data.describe().to_markdown()))\n\n\n\n\n\n  \n    \n      \n      COUNTY_FIPS\n      WorkDate\n      MDScensus\n      Hrs_RNDON\n      Hrs_RNDON_emp\n      Hrs_RNDON_ctr\n      Hrs_RNadmin\n      Hrs_RNadmin_emp\n      Hrs_RNadmin_ctr\n      Hrs_RN\n      ...\n      Hrs_LPN_ctr\n      Hrs_CNA\n      Hrs_CNA_emp\n      Hrs_CNA_ctr\n      Hrs_NAtrn\n      Hrs_NAtrn_emp\n      Hrs_NAtrn_ctr\n      Hrs_MedAide\n      Hrs_MedAide_emp\n      Hrs_MedAide_ctr\n    \n  \n  \n    \n      count\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      ...\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n      1330966.0\n    \n    \n      mean\n      91.1\n      20240215.7\n      83.4\n      5.2\n      5.1\n      0.1\n      10.3\n      10.0\n      0.2\n      34.4\n      ...\n      6.5\n      171.2\n      158.2\n      13.0\n      4.2\n      4.2\n      0.1\n      8.5\n      8.3\n      0.2\n    \n    \n      std\n      99.2\n      83.0\n      49.1\n      4.5\n      4.5\n      0.9\n      14.9\n      14.6\n      1.8\n      34.7\n      ...\n      16.2\n      113.7\n      106.3\n      32.6\n      13.1\n      12.7\n      2.1\n      17.6\n      17.2\n      2.2\n    \n    \n      min\n      1.0\n      20240101.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      ...\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n    \n    \n      25%\n      31.0\n      20240123.0\n      51.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      13.0\n      ...\n      0.0\n      97.0\n      88.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n    \n    \n      50%\n      69.0\n      20240215.0\n      76.0\n      8.0\n      8.0\n      0.0\n      7.5\n      7.4\n      0.0\n      25.6\n      ...\n      0.0\n      148.1\n      136.8\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n      0.0\n    \n    \n      75%\n      117.0\n      20240309.0\n      104.0\n      8.0\n      8.0\n      0.0\n      16.0\n      16.0\n      0.0\n      44.8\n      ...\n      5.8\n      217.0\n      203.1\n      11.0\n      0.0\n      0.0\n      0.0\n      11.2\n      10.8\n      0.0\n    \n    \n      max\n      840.0\n      20240331.0\n      743.0\n      327.8\n      327.8\n      42.0\n      266.2\n      266.2\n      92.5\n      908.6\n      ...\n      454.0\n      1857.7\n      1573.1\n      694.3\n      452.0\n      279.0\n      280.5\n      395.6\n      395.6\n      128.9\n    \n  \n\n8 rows × 27 columns\n\n\n\n\n\nCode\nattributes = [\"Hrs_RN\", \"Hrs_LPN_ctr\", \"Hrs_CNA\", \"Hrs_NAtrn\", \"Hrs_MedAide\"]\nn = len(attributes)\n\nfig, axs = plt.subplots(n, n, figsize=(8, 8))\nscatter_matrix(\n    data[attributes].sample(200),\n    ax=axs, alpha=.7,\n    hist_kwds=dict(bins=15, linewidth=0)\n)\nfig.align_ylabels(axs[:, 0])\nfig.align_xlabels(axs[-1, :])\nfor ax in axs.flatten():\n    ax.tick_params(axis='both', which='both', length=3.5)\n\n# save_fig(\"scatter_matrix_plot\")\n\nplt.show()\n\n\n\n\n\n\n\n\nFigure 1: Scatter matrix of nursing worker working hours\n\n\n\n\n\n\n\nCode\nimport pandas as pd\ndf = pd.DataFrame({'name': ['arizona', '', 'berlin', 'london']})\n\nfrom geopy.geocoders import Nominatim\ngeolocator = Nominatim(user_agent=\"geo_clipboard\")\n\nfrom geopy.extra.rate_limiter import RateLimiter\ngeocode = RateLimiter(geolocator.geocode, min_delay_seconds=1)\ndf['location'] = df['name'].apply(geocode)\n\ndf['point'] = df['location'].apply(lambda loc: tuple(loc.point) if loc else None)\n\n\n\n\nCode\ndf\n\n\n\n\n\n  \n    \n      \n      name\n      location\n      point\n    \n  \n  \n    \n      0\n      arizona\n      (Arizona, United States, (34.395342, -111.7632...\n      (34.395342, -111.763275, 0.0)\n    \n    \n      1\n      \n      None\n      None\n    \n    \n      2\n      berlin\n      (Berlin, Deutschland, (52.510885, 13.3989367))\n      (52.510885, 13.3989367, 0.0)\n    \n    \n      3\n      london\n      (London, Greater London, England, United Kingd...\n      (51.4893335, -0.14405508452768728, 0.0)\n    \n  \n\n\n\n\n\n\nCode\nfrom great_tables import GT\n\ndf = data.loc[150000:, [\n    \"STATE\",\n    \"COUNTY_NAME\", \"COUNTY_FIPS\",\n    \"CITY\",\n    \"PROVNAME\", \"PROVNUM\",\n    # \"MDScensus\"\n]].value_counts().reset_index()\nGT(df.head(n=10))\n\n\n\n\n\n\n\n\n  STATE\n  COUNTY_NAME\n  COUNTY_FIPS\n  CITY\n  PROVNAME\n  PROVNUM\n  count\n\n\n\n  \n    CA\n    Alameda\n    1\n    ALAMEDA\n    ALAMEDA HEALTHCARE & WELLNESS CENTER\n    555486\n    91\n  \n  \n    OH\n    Mahoning\n    99\n    AUSTINTOWN\n    AVENTURA  AT HUMILITY HOUSE\n    366186\n    91\n  \n  \n    OH\n    Lucas\n    95\n    TOLEDO\n    OHIO LIVING SWAN CREEK\n    365996\n    91\n  \n  \n    OH\n    Lucas\n    95\n    TOLEDO\n    OTTERBEIN SUNSET HOUSE\n    366148\n    91\n  \n  \n    OH\n    Lucas\n    95\n    TOLEDO\n    PARK TERRACE NURSING AND REHABILITATION CENTER\n    365339\n    91\n  \n  \n    OH\n    Lucas\n    95\n    TOLEDO\n    POINT PLACE HEALTHCARE AND REHABILITATION CENTER\n    366039\n    91\n  \n  \n    OH\n    Lucas\n    95\n    WATERVILLE\n    ASTORIA PLACE OF WATERVILLE\n    365747\n    91\n  \n  \n    OH\n    Lucas\n    95\n    WATERVILLE\n    AYDEN HEALTHCARE OF WATERVILLE\n    365617\n    91\n  \n  \n    OH\n    Lucas\n    95\n    WHITEHOUSE\n    WHITEHOUSE COUNTRY MANOR\n    365756\n    91\n  \n  \n    OH\n    Madison\n    97\n    LONDON\n    LONDON HEALTH & REHAB CENTER\n    365241\n    91"
  },
  {
    "objectID": "notebooks/report.html#some-gt-examples",
    "href": "notebooks/report.html#some-gt-examples",
    "title": "Nurse Staffing Recommendations",
    "section": "Some GT examples",
    "text": "Some GT examples\n\n\nCode\nfrom typing import Any\nfrom IPython.display import display as ipy_display, HTML\nimport numpy as np\n\ndef display2(\n    *args,\n    globs: dict[str, Any] | None = None,\n    bold: bool = True,\n    width: str = \"400px\"  # Fixed width for each block\n) -&gt; None:\n    \"\"\"\n    Display an informative representation of multiple objects side-by-side in Jupyter.\n\n    Parameters\n    ----------\n    *args : tuple\n        Tuple of expressions to evaluate and display.\n    globs : dict[str, Any], default=None\n        Global namespace, to give eval() access to nonlocals passed by name.\n    bold : bool, default=True\n        Option to enable/disable string styling.\n    width : str, default=\"400px\"\n        Fixed width for each displayed block in the Jupyter notebook.\n\n    Warnings\n    --------\n    This function uses `eval()` to render expressions it receives\n    as strings. Access to variables in the global namespace is controlled\n    by `globs`. Take care to only pass trusted expressions to the function.\n    \"\"\"\n\n    if globs is None:\n        globs = {}\n\n    outputs = []\n    for arg in args:\n        name = f\"&lt;b&gt;{arg}&lt;/b&gt;\" if bold else arg\n        value = np.round(eval(arg, globs), 2)\n        shape = np.shape(value)\n        content = f\"&lt;div style='width:{width}; padding:10px; float:left;'&gt;&lt;pre&gt;{name}\\n--- {repr(shape)} ---\\n{repr(value)}&lt;/pre&gt;&lt;/div&gt;\"\n        outputs.append(content)\n\n    # Clearfix for layout\n    clearfix = \"&lt;div style='clear: both;'&gt;&lt;/div&gt;\"\n\n    # Display the HTML content in Jupyter\n    html_output = ''.join(outputs) + clearfix\n    ipy_display(HTML(html_output))\n\n    return None\n\n\n\n\nCode\nA = np.array([[1, 3], [2, 4]])\nx = np.array([[0, 1]])\n\ndisplay2(\n    \"A\", \"x.T\", \"np.dot(A, x.T)\", globs=globals(), bold=True, width=\"100px\"\n)\n\n\nA\n--- (2, 2) ---\narray([[1, 3],\n       [2, 4]])x.T\n--- (2, 1) ---\narray([[0],\n       [1]])np.dot(A, x.T)\n--- (2, 1) ---\narray([[3],\n       [4]])\n\n\n\n\nCode\ndisplay2(\n    \"data['STATE'].value_counts()\",\n    \"data['COUNTY_NAME'].value_counts()\",\n    \"data['CITY'].value_counts()\",\n    \"data['PROVNAME'].value_counts()\",\n    \"data['MDScensus'].value_counts()\",\n    width=\"340px\",\n    globs=globals()\n)\n\n\ndata['STATE'].value_counts()\n--- (52,) ---\nSTATE\nTX    105924\nCA    103740\nOH     83538\nFL     63245\nIL     61425\nPA     60515\nNY     54691\nIN     46501\nMO     44226\nMI     38402\nNC     37310\nIA     36036\nGA     31941\nNJ     31395\nMA     31122\nMN     30758\nWI     29484\nTN     27300\nKS     27118\nVA     26117\nOK     25116\nKY     24115\nLA     23751\nAL     20293\nMD     20020\nAR     19747\nCO     19110\nMS     18200\nCT     17836\nWA     17199\nSC     16835\nNE     16289\nAZ     12649\nOR     11557\nWV     11102\nUT      8918\nSD      8554\nME      7371\nID      7280\nND      6734\nRI      6643\nNH      6643\nNM      6006\nNV      5824\nMT      5369\nDE      3913\nHI      3731\nVT      3094\nWY      2912\nDC      1547\nAK      1365\nPR       455\nName: count, dtype: int64data['COUNTY_NAME'].value_counts()\n--- (1671,) ---\nCOUNTY_NAME\nLos Angeles    33124\nCook           18564\nMontgomery     16835\nJefferson      16471\nWashington     12831\n               ...  \nLanier            91\nTwiggs            91\nVinton            91\nBoundary          91\nRefugio           91\nName: count, Length: 1671, dtype: int64data['CITY'].value_counts()\n--- (5092,) ---\nCITY\nCHICAGO          7098\nLOS ANGELES      6916\nCINCINNATI       6279\nHOUSTON          5824\nSAN ANTONIO      5460\n                 ... \nLINCROFT           91\nWYCKOFF            91\nFLORHAM PARK       91\nNEW BRUNSWICK      91\nHORSESHOE BAY      91\nName: count, Length: 5092, dtype: int64data['PROVNAME'].value_counts()\n--- (14441,) ---\nPROVNAME\nMILLER'S MERRY MANOR                                  1092\nPARKVIEW CARE CENTER                                   455\nLITTLE SISTERS OF THE POOR                             455\nHERITAGE MANOR                                         273\nRIVERSIDE NURSING AND REHABILITATION CENTER            273\n                                                      ... \nMORGANFIELD NURSING AND REHABILITATION CENTER           91\nCAMPBELLSVILLE NURSING AND REHABILITATION CENTER        91\nFRANKLIN-SIMPSON NURSING AND REHABILITATION CENTER      91\nGRAND HAVEN NURSING HOME                                91\nTIERRA ESTE NURSING AND REHABILITATION CENTER           91\nName: count, Length: 14441, dtype: int64data['MDScensus'].value_counts()\n--- (635,) ---\nMDScensus\n56     15160\n57     15116\n58     15051\n55     14830\n53     14618\n       ...  \n622        1\n629        1\n730        1\n634        1\n617        1\nName: count, Length: 635, dtype: int64\n\n\n\n\nCode\ndata[[\"CY_Qtr\", \"WorkDate\", \"MDScensus\"]]\n\n\n\n\n\n  \n    \n      \n      CY_Qtr\n      WorkDate\n      MDScensus\n    \n  \n  \n    \n      0\n      2024Q1\n      20240101\n      50\n    \n    \n      1\n      2024Q1\n      20240102\n      49\n    \n    \n      2\n      2024Q1\n      20240103\n      49\n    \n    \n      3\n      2024Q1\n      20240104\n      50\n    \n    \n      4\n      2024Q1\n      20240105\n      51\n    \n    \n      ...\n      ...\n      ...\n      ...\n    \n    \n      1330961\n      2024Q1\n      20240327\n      81\n    \n    \n      1330962\n      2024Q1\n      20240328\n      83\n    \n    \n      1330963\n      2024Q1\n      20240329\n      85\n    \n    \n      1330964\n      2024Q1\n      20240330\n      82\n    \n    \n      1330965\n      2024Q1\n      20240331\n      82\n    \n  \n\n1330966 rows × 3 columns"
  },
  {
    "objectID": "notebooks/report.html#sql",
    "href": "notebooks/report.html#sql",
    "title": "Nurse Staffing Recommendations",
    "section": "SQL",
    "text": "SQL"
  }
]